import { expect } from 'chai';
import { CurrencyAmount, Token, TradeType } from '@uniswap/sdk-core';
import { CacheMode, ChainId } from '@tartz-one/smart-order-router';
import { CACHED_ROUTES_CONFIGURATION, PairTradeTypeChainId, } from '../../../../../lib/handlers/router-entities/route-caching';
describe('CachedRoutesConfiguration', () => {
    const WETH = new Token(ChainId.MAINNET, '0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2', 18, 'WETH');
    it('can find the strategy for a pair with configuration', () => {
        const pairToLookup = new PairTradeTypeChainId({
            tokenIn: '0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2',
            tokenOut: '0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48',
            tradeType: TradeType.EXACT_INPUT,
            chainId: ChainId.MAINNET,
        });
        const fetchedStrategy = CACHED_ROUTES_CONFIGURATION.get(pairToLookup.toString());
        expect(fetchedStrategy).to.not.be.undefined;
        const currencyAmount = CurrencyAmount.fromRawAmount(WETH, 1 * 10 ** WETH.decimals);
        const cachingParameters = fetchedStrategy === null || fetchedStrategy === void 0 ? void 0 : fetchedStrategy.getCachingBucket(currencyAmount);
        expect(cachingParameters === null || cachingParameters === void 0 ? void 0 : cachingParameters.bucket).to.eq(1);
        expect(cachingParameters === null || cachingParameters === void 0 ? void 0 : cachingParameters.cacheMode).to.eq(CacheMode.Livemode);
    });
    it('can find the strategy, even if token has different capitalization', () => {
        const pairToLookup = new PairTradeTypeChainId({
            tokenIn: '0xC02AAA39b223fe8d0a0e5c4f27EAD9083c756cc2',
            tokenOut: '0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48',
            tradeType: TradeType.EXACT_INPUT,
            chainId: ChainId.MAINNET,
        });
        const fetchedStrategy = CACHED_ROUTES_CONFIGURATION.get(pairToLookup.toString());
        expect(fetchedStrategy).to.not.be.undefined;
        const currencyAmount = CurrencyAmount.fromRawAmount(WETH, 1 * 10 ** WETH.decimals);
        const cachingParameters = fetchedStrategy === null || fetchedStrategy === void 0 ? void 0 : fetchedStrategy.getCachingBucket(currencyAmount);
        expect(cachingParameters === null || cachingParameters === void 0 ? void 0 : cachingParameters.bucket).to.eq(1);
    });
    it('can find the strategy using a different amount', () => {
        const pairToLookup = new PairTradeTypeChainId({
            tokenIn: '0xC02AAA39b223fe8d0a0e5c4f27EAD9083c756cc2',
            tokenOut: '0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48',
            tradeType: TradeType.EXACT_INPUT,
            chainId: ChainId.MAINNET,
        });
        const fetchedStrategy = CACHED_ROUTES_CONFIGURATION.get(pairToLookup.toString());
        expect(fetchedStrategy).to.not.be.undefined;
        const currencyAmount = CurrencyAmount.fromRawAmount(WETH, 5 * 10 ** WETH.decimals);
        const cachingParameters = fetchedStrategy === null || fetchedStrategy === void 0 ? void 0 : fetchedStrategy.getCachingBucket(currencyAmount);
        expect(cachingParameters === null || cachingParameters === void 0 ? void 0 : cachingParameters.bucket).to.eq(5);
    });
    it('returns undefined when strategy doesnt exist', () => {
        const pairToLookup = new PairTradeTypeChainId({
            tokenIn: '0xC02AAA39b223fe8d0a0e5c4f27EAD9083c756cc2',
            tokenOut: '0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48',
            tradeType: TradeType.EXACT_OUTPUT,
            chainId: ChainId.MAINNET,
        });
        const fetchedStrategy = CACHED_ROUTES_CONFIGURATION.get(pairToLookup.toString());
        expect(fetchedStrategy).to.be.undefined;
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FjaGVkLXJvdXRlcy1jb25maWd1cmF0aW9uLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi90ZXN0L3VuaXQvaGFuZGxlcnMvcm91dGVyLWVudGl0aWVzL3JvdXRlLWNhY2hpbmcvY2FjaGVkLXJvdXRlcy1jb25maWd1cmF0aW9uLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLE1BQU0sQ0FBQTtBQUM3QixPQUFPLEVBQUUsY0FBYyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQTtBQUNwRSxPQUFPLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRSxNQUFNLCtCQUErQixDQUFBO0FBQ2xFLE9BQU8sRUFDTCwyQkFBMkIsRUFDM0Isb0JBQW9CLEdBQ3JCLE1BQU0sMkRBQTJELENBQUE7QUFFbEUsUUFBUSxDQUFDLDJCQUEyQixFQUFFLEdBQUcsRUFBRTtJQUN6QyxNQUFNLElBQUksR0FBRyxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLDRDQUE0QyxFQUFFLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQTtJQUVqRyxFQUFFLENBQUMscURBQXFELEVBQUUsR0FBRyxFQUFFO1FBQzdELE1BQU0sWUFBWSxHQUFHLElBQUksb0JBQW9CLENBQUM7WUFDNUMsT0FBTyxFQUFFLDRDQUE0QztZQUNyRCxRQUFRLEVBQUUsNENBQTRDO1lBQ3RELFNBQVMsRUFBRSxTQUFTLENBQUMsV0FBVztZQUNoQyxPQUFPLEVBQUUsT0FBTyxDQUFDLE9BQU87U0FDekIsQ0FBQyxDQUFBO1FBRUYsTUFBTSxlQUFlLEdBQUcsMkJBQTJCLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFBO1FBRWhGLE1BQU0sQ0FBQyxlQUFlLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxTQUFTLENB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RSw0Q0FBNEM7WUFDckQsUUFBUSxFQUFFLDRDQUE0QztZQUN0RCxTQUFTLEVBQUUsU0FBUyxDQUFDLFlBQVk7WUFDakMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxPQUFPO1NBQ3pCLENBQUMsQ0FBQTtRQUVGLE1BQU0sZUFBZSxHQUFHLDJCQUEyQixDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQTtRQUVoRixNQUFNLENBQUMsZUFBZSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUE7SUFDekMsQ0FBQyxDQUFDLENBQUE7QUFDSixDQUFDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV4cGVjdCB9IGZyb20gJ2NoYWknXG5pbXBvcnQgeyBDdXJyZW5jeUFtb3VudCwgVG9rZW4sIFRyYWRlVHlwZSB9IGZyb20gJ0B1bmlzd2FwL3Nkay1jb3JlJ1xuaW1wb3J0IHsgQ2FjaGVNb2RlLCBDaGFpbklkIH0gZnJvbSAnQHRhcnR6LW9uZS9zbWFydC1vcmRlci1yb3V0ZXInXG5pbXBvcnQge1xuICBDQUNIRURfUk9VVEVTX0NPTkZJR1VSQVRJT04sXG4gIFBhaXJUcmFkZVR5cGVDaGFpbklkLFxufSBmcm9tICcuLi8uLi8uLi8uLi8uLi9saWIvaGFuZGxlcnMvcm91dGVyLWVudGl0aWVzL3JvdXRlLWNhY2hpbmcnXG5cbmRlc2NyaWJlKCdDYWNoZWRSb3V0ZXNDb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICBjb25zdCBXRVRIID0gbmV3IFRva2VuKENoYWluSWQuTUFJTk5FVCwgJzB4YzAyYWFhMzliMjIzZmU4ZDBhMGU1YzRmMjdlYWQ5MDgzYzc1NmNjMicsIDE4LCAnV0VUSCcpXG5cbiAgaXQoJ2NhbiBmaW5kIHRoZSBzdHJhdGVneSBmb3IgYSBwYWlyIHdpdGggY29uZmlndXJhdGlvbicsICgpID0+IHtcbiAgICBjb25zdCBwYWlyVG9Mb29rdXAgPSBuZXcgUGFpclRyYWRlVHlwZUNoYWluSWQoe1xuICAgICAgdG9rZW5JbjogJzB4YzAyYWFhMzliMjIzZmU4ZDBhMGU1YzRmMjdlYWQ5MDgzYzc1NmNjMicsIC8vIFdFVEhcbiAgICAgIHRva2VuT3V0OiAnMHhhMGI4Njk5MWM2MjE4YjM2YzFkMTlkNGEyZTllYjBjZTM2MDZlYjQ4JywgLy8gVVNEQ1xuICAgICAgdHJhZGVUeXBlOiBUcmFkZVR5cGUuRVhBQ1RfSU5QVVQsXG4gICAgICBjaGFpbklkOiBDaGFpbklkLk1BSU5ORVQsXG4gICAgfSlcblxuICAgIGNvbnN0IGZldGNoZWRTdHJhdGVneSA9IENBQ0hFRF9ST1VURVNfQ09ORklHVVJBVElPTi5nZXQocGFpclRvTG9va3VwLnRvU3RyaW5nKCkpXG5cbiAgICBleHBlY3QoZmV0Y2hlZFN0cmF0ZWd5KS50by5ub3QuYmUudW5kZWZpbmVkXG5cbiAgICBjb25zdCBjdXJyZW5jeUFtb3VudCA9IEN1cnJlbmN5QW1vdW50LmZyb21SYXdBbW91bnQoV0VUSCwgMSAqIDEwICoqIFdFVEguZGVjaW1hbHMpXG4gICAgY29uc3QgY2FjaGluZ1BhcmFtZXRlcnMgPSBmZXRjaGVkU3RyYXRlZ3k/LmdldENhY2hpbmdCdWNrZXQoY3VycmVuY3lBbW91bnQpXG5cbiAgICBleHBlY3QoY2FjaGluZ1BhcmFtZXRlcnM/LmJ1Y2tldCkudG8uZXEoMSlcbiAgICBleHBlY3QoY2FjaGluZ1BhcmFtZXRlcnM/LmNhY2hlTW9kZSkudG8uZXEoQ2FjaGVNb2RlLkxpdmVtb2RlKVxuICB9KVxuXG4gIGl0KCdjYW4gZmluZCB0aGUgc3RyYXRlZ3ksIGV2ZW4gaWYgdG9rZW4gaGFzIGRpZmZlcmVudCBjYXBpdGFsaXphdGlvbicsICgpID0+IHtcbiAgICBjb25zdCBwYWlyVG9Mb29rdXAgPSBuZXcgUGFpclRyYWRlVHlwZUNoYWluSWQoe1xuICAgICAgdG9rZW5JbjogJzB4QzAyQUFBMzliMjIzZmU4ZDBhMGU1YzRmMjdFQUQ5MDgzYzc1NmNjMicsIC8vIFdFVEhcbiAgICAgIHRva2VuT3V0OiAnMHhhMGI4Njk5MWM2MjE4YjM2YzFkMTlkNGEyZTllYjBjZTM2MDZlYjQ4JywgLy8gVVNEQ1xuICAgICAgdHJhZGVUeXBlOiBUcmFkZVR5cGUuRVhBQ1RfSU5QVVQsXG4gICAgICBjaGFpbklkOiBDaGFpbklkLk1BSU5ORVQsXG4gICAgfSlcblxuICAgIGNvbnN0IGZldGNoZWRTdHJhdGVneSA9IENBQ0hFRF9ST1VURVNfQ09ORklHVVJBVElPTi5nZXQocGFpclRvTG9va3VwLnRvU3RyaW5nKCkpXG5cbiAgICBleHBlY3QoZmV0Y2hlZFN0cmF0ZWd5KS50by5ub3QuYmUudW5kZWZpbmVkXG5cbiAgICBjb25zdCBjdXJyZW5jeUFtb3VudCA9IEN1cnJlbmN5QW1vdW50LmZyb21SYXdBbW91bnQoV0VUSCwgMSAqIDEwICoqIFdFVEguZGVjaW1hbHMpXG4gICAgY29uc3QgY2FjaGluZ1BhcmFtZXRlcnMgPSBmZXRjaGVkU3RyYXRlZ3k/LmdldENhY2hpbmdCdWNrZXQoY3VycmVuY3lBbW91bnQpXG5cbiAgICBleHBlY3QoY2FjaGluZ1BhcmFtZXRlcnM/LmJ1Y2tldCkudG8uZXEoMSlcbiAgfSlcblxuICBpdCgnY2FuIGZpbmQgdGhlIHN0cmF0ZWd5IHVzaW5nIGEgZGlmZmVyZW50IGFtb3VudCcsICgpID0+IHtcbiAgICBjb25zdCBwYWlyVG9Mb29rdXAgPSBuZXcgUGFpclRyYWRlVHlwZUNoYWluSWQoe1xuICAgICAgdG9rZW5JbjogJzB4QzAyQUFBMzliMjIzZmU4ZDBhMGU1YzRmMjdFQUQ5MDgzYzc1NmNjMicsIC8vIFdFVEhcbiAgICAgIHRva2VuT3V0OiAnMHhhMGI4Njk5MWM2MjE4YjM2YzFkMTlkNGEyZTllYjBjZTM2MDZlYjQ4JywgLy8gVVNEQ1xuICAgICAgdHJhZGVUeXBlOiBUcmFkZVR5cGUuRVhBQ1RfSU5QVVQsXG4gICAgICBjaGFpbklkOiBDaGFpbklkLk1BSU5ORVQsXG4gICAgfSlcblxuICAgIGNvbnN0IGZldGNoZWRTdHJhdGVneSA9IENBQ0hFRF9ST1VURVNfQ09ORklHVVJBVElPTi5nZXQocGFpclRvTG9va3VwLnRvU3RyaW5nKCkpXG5cbiAgICBleHBlY3QoZmV0Y2hlZFN0cmF0ZWd5KS50by5ub3QuYmUudW5kZWZpbmVkXG5cbiAgICBjb25zdCBjdXJyZW5jeUFtb3VudCA9IEN1cnJlbmN5QW1vdW50LmZyb21SYXdBbW91bnQoV0VUSCwgNSAqIDEwICoqIFdFVEguZGVjaW1hbHMpXG4gICAgY29uc3QgY2FjaGluZ1BhcmFtZXRlcnMgPSBmZXRjaGVkU3RyYXRlZ3k/LmdldENhY2hpbmdCdWNrZXQoY3VycmVuY3lBbW91bnQpXG5cbiAgICBleHBlY3QoY2FjaGluZ1BhcmFtZXRlcnM/LmJ1Y2tldCkudG8uZXEoNSlcbiAgfSlcblxuICBpdCgncmV0dXJucyB1bmRlZmluZWQgd2hlbiBzdHJhdGVneSBkb2VzbnQgZXhpc3QnLCAoKSA9PiB7XG4gICAgY29uc3QgcGFpclRvTG9va3VwID0gbmV3IFBhaXJUcmFkZVR5cGVDaGFpbklkKHtcbiAgICAgIHRva2VuSW46ICcweEMwMkFBQTM5YjIyM2ZlOGQwYTBlNWM0ZjI3RUFEOTA4M2M3NTZjYzInLCAvLyBXRVRIXG4gICAgICB0b2tlbk91dDogJzB4YTBiODY5OTFjNjIxOGIzNmMxZDE5ZDRhMmU5ZWIwY2UzNjA2ZWI0OCcsIC8vIFVTRENcbiAgICAgIHRyYWRlVHlwZTogVHJhZGVUeXBlLkVYQUNUX09VVFBVVCxcbiAgICAgIGNoYWluSWQ6IENoYWluSWQuTUFJTk5FVCxcbiAgICB9KVxuXG4gICAgY29uc3QgZmV0Y2hlZFN0cmF0ZWd5ID0gQ0FDSEVEX1JPVVRFU19DT05GSUdVUkFUSU9OLmdldChwYWlyVG9Mb29rdXAudG9TdHJpbmcoKSlcblxuICAgIGV4cGVjdChmZXRjaGVkU3RyYXRlZ3kpLnRvLmJlLnVuZGVmaW5lZFxuICB9KVxufSlcbiJdfQ==