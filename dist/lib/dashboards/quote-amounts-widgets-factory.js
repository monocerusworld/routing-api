import { TradeType } from '@uniswap/sdk-core';
import { ID_TO_NETWORK_NAME } from '@tartz-one/smart-order-router';
import _ from 'lodash';
import { PAIRS_TO_TRACK } from '../handlers/quote/util/pairs-to-track';
export class QuoteAmountsWidgetsFactory {
    constructor(namespace, region) {
        this.region = region;
        this.namespace = namespace;
    }
    generateWidgets() {
        const pairsToTrackEntries = Array.from(PAIRS_TO_TRACK.entries());
        const widgets = _.flatMap(pairsToTrackEntries, ([chainId, pairsByTradeType]) => {
            return this.generateChartWidgetsFromPairsByTradeType(chainId, pairsByTradeType);
        });
        return widgets;
    }
    generateChartWidgetsFromPairsByTradeType(chainId, pairsByTradeType) {
        const pairsByTradeTypeEntries = Array.from(pairsByTradeType.entries());
        const widgets = _.flatMap(pairsByTradeTypeEntries, ([tradeType, pairs]) => this.generateChartWidgetsFromPairs(chainId, tradeType, pairs));
        return widgets;
    }
    generateChartWidgetsFromPairs(chainId, tradeType, pairs) {
        return _.flatMap(pairs, (pair) => this.generateChartWidgetsFromPair(chainId, tradeType, pair));
    }
    generateChartWidgetsFromPair(chainId, tradeType, pair) {
        const tradeTypeLabel = this.tradeTypeToString(tradeType);
        const widgets = [
            {
                type: 'text',
                width: 24,
                height: 2,
                properties: {
                    markdown: `# ${ID_TO_NETWORK_NAME(chainId)} - ChainId: ${chainId}\n## ${pair} - ${tradeTypeLabel}`,
                },
            },
            {
                type: 'metric',
                width: 24,
                height: 6,
                properties: {
                    view: 'timeSeries',
                    stacked: false,
                    metrics: [
                        [
                            this.namespace,
                            `GET_QUOTE_AMOUNT_${pair}_${tradeTypeLabel.toUpperCase()}_CHAIN_${chainId}`,
                            'Service',
                            'RoutingAPI',
                            { label: `${pair}/${tradeTypeLabel.toUpperCase()} Quotes` },
                        ],
                    ],
                    region: this.region,
                    title: `Number of requested quotes ${pair}/${tradeTypeLabel}`,
                    period: 300,
                    stat: 'SampleCount',
                },
            },
            {
                type: 'metric',
                width: 24,
                height: 9,
                properties: {
                    view: 'timeSeries',
                    stacked: true,
                    metrics: [
                        [
                            this.namespace,
                            `GET_QUOTE_AMOUNT_${pair}_${tradeTypeLabel.toUpperCase()}_CHAIN_${chainId}`,
                            'Service',
                            'RoutingAPI',
                            this.generateStatWithLabel(0, 1, pair, tradeType),
                        ],
                        ['...', this.generateStatWithLabel(1, 5, pair, tradeType)],
                        ['...', this.generateStatWithLabel(5, 10, pair, tradeType)],
                        ['...', this.generateStatWithLabel(10, 50, pair, tradeType)],
                        ['...', this.generateStatWithLabel(50, 100, pair, tradeType)],
                        ['...', this.generateStatWithLabel(100, 500, pair, tradeType)],
                        ['...', this.generateStatWithLabel(500, 1000, pair, tradeType)],
                        ['...', this.generateStatWithLabel(1000, 5000, pair, tradeType)],
                        ['...', this.generateStatWithLabel(5000, 10000, pair, tradeType)],
                        ['...', this.generateStatWithLabel(10000, 50000, pair, tradeType)],
                        ['...', this.generateStatWithLabel(50000, 100000, pair, tradeType)],
                        ['...', this.generateStatWithLabel(100000, 500000, pair, tradeType)],
                        ['...', this.generateStatWithLabel(500000, 1000000, pair, tradeType)],
                        ['...', this.generateStatWithLabel(1000000, -1, pair, tradeType)],
                    ],
                    region: this.region,
                    title: `Distribution of quotes ${pair}/${tradeTypeLabel}`,
                    period: 300,
                },
            },
        ];
        return widgets;
    }
    tradeTypeToString(tradeType) {
        if (tradeType == TradeType.EXACT_INPUT) {
            return 'ExactIn';
        }
        else {
            return 'ExactOut';
        }
    }
    generateStatWithLabel(min, max, pair, tradeType) {
        const tokens = pair.split('/');
        const maxNormalized = max > 0 ? max.toString() : '';
        switch (tradeType) {
            case TradeType.EXACT_INPUT:
                return {
                    stat: `PR(${min}:${maxNormalized})`,
                    label: `${min} to ${max} ${tokens[0]}`,
                };
            case TradeType.EXACT_OUTPUT:
                return {
                    stat: `PR(${min}:${maxNormalized})`,
                    label: `${min} to ${max} ${tokens[1]}`,
                };
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicXVvdGUtYW1vdW50cy13aWRnZXRzLWZhY3RvcnkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9saWIvZGFzaGJvYXJkcy9xdW90ZS1hbW91bnRzLXdpZGdldHMtZmFjdG9yeS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sbUJBQW1CLENBQUE7QUFDN0MsT0FBTyxFQUFXLGtCQUFrQixFQUFFLE1BQU0sK0JBQStCLENBQUE7QUFDM0UsT0FBTyxDQUFDLE1BQU0sUUFBUSxDQUFBO0FBQ3RCLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSx1Q0FBdUMsQ0FBQTtBQUl0RSxNQUFNLE9BQU8sMEJBQTBCO0lBSXJDLFlBQVksU0FBaUIsRUFBRSxNQUFjO1FBQzNDLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFBO1FBQ3BCLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFBO0lBQzVCLENBQUM7SUFFRCxlQUFlO1FBQ2IsTUFBTSxtQkFBbUIsR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFBO1FBQ2hFLE1BQU0sT0FBTyxHQUFhLENBQUMsQ0FBQyxPQUFPLENBQUMsbUJBQW1CLEVBQUUsQ0FBQyxDQUFDLE9BQU8sRUFBRSxnQkFBZ0IsQ0FBQyxFQUFFLEVBQUU7WUFDdkYsT0FBTyxJQUFJLENBQUMsd0NBQXdDLENBQUMsT0FBTyxFQUFFLGdCQUFnQixDQUFDLENBQUE7UUFDakYsQ0FBQyxDQUFDLENBQUE7UUFFRixPQUFPLE9BQU8sQ0FBQTtJQUNoQixDQUFDO0lBRU8sd0NBQXdDLENBQzlDLE9BQWdCLEVBQ2hCLGdCQUEwQztRQUUxQyxNQUFNLHVCQUF1QixHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQTtRQUV0RSxNQUFNLE9BQU8sR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFD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RixDQUFBO1FBRUQsT0FBTyxPQUFPLENBQUE7SUFDaEIsQ0FBQztJQUVPLGlCQUFpQixDQUFDLFNBQW9CO1FBQzVDLElBQUksU0FBUyxJQUFJLFNBQVMsQ0FBQyxXQUFXLEVBQUU7WUFDdEMsT0FBTyxTQUFTLENBQUE7U0FDakI7YUFBTTtZQUNMLE9BQU8sVUFBVSxDQUFBO1NBQ2xCO0lBQ0gsQ0FBQztJQUVPLHFCQUFxQixDQUMzQixHQUFXLEVBQ1gsR0FBVyxFQUNYLElBQVksRUFDWixTQUFvQjtRQUVwQixNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQzlCLE1BQU0sYUFBYSxHQUFHLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFBO1FBRW5ELFFBQVEsU0FBUyxFQUFFO1lBQ2pCLEtBQUssU0FBUyxDQUFDLFdBQVc7Z0JBQ3hCLE9BQU87b0JBQ0wsSUFBSSxFQUFFLE1BQU0sR0FBRyxJQUFJLGFBQWEsR0FBRztvQkFDbkMsS0FBSyxFQUFFLEdBQUcsR0FBRyxPQUFPLEdBQUcsSUFBSSxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUU7aUJBQ3ZDLENBQUE7WUFDSCxLQUFLLFNBQVMsQ0FBQyxZQUFZO2dCQUN6QixPQUFPO29CQUNMLElBQUksRUFBRSxNQUFNLEdBQUcsSUFBSSxhQUFhLEdBQUc7b0JBQ25DLEtBQUssRUFBRSxHQUFHLEdBQUcsT0FBTyxHQUFHLElBQUksTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFO2lCQUN2QyxDQUFBO1NBQ0o7SUFDSCxDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUcmFkZVR5cGUgfSBmcm9tICdAdW5pc3dhcC9zZGstY29yZSdcbmltcG9ydCB7IENoYWluSWQsIElEX1RPX05FVFdPUktfTkFNRSB9IGZyb20gJ0B0YXJ0ei1vbmUvc21hcnQtb3JkZXItcm91dGVyJ1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuaW1wb3J0IHsgUEFJUlNfVE9fVFJBQ0sgfSBmcm9tICcuLi9oYW5kbGVycy9xdW90ZS91dGlsL3BhaXJzLXRvLXRyYWNrJ1xuaW1wb3J0IHsgV2lkZ2V0IH0gZnJvbSAnLi9jb3JlL21vZGVsL3dpZGdldCdcbmltcG9ydCB7IFdpZGdldHNGYWN0b3J5IH0gZnJvbSAnLi9jb3JlL3dpZGdldHMtZmFjdG9yeSdcblxuZXhwb3J0IGNsYXNzIFF1b3RlQW1vdW50c1dpZGdldHNGYWN0b3J5IGltcGxlbWVudHMgV2lkZ2V0c0ZhY3Rvcnkge1xuICByZWdpb246IHN0cmluZ1xuICBuYW1lc3BhY2U6IHN0cmluZ1xuXG4gIGNvbnN0cnVjdG9yKG5hbWVzcGFjZTogc3RyaW5nLCByZWdpb246IHN0cmluZykge1xuICAgIHRoaXMucmVnaW9uID0gcmVnaW9uXG4gICAgdGhpcy5uYW1lc3BhY2UgPSBuYW1lc3BhY2VcbiAgfVxuXG4gIGdlbmVyYXRlV2lkZ2V0cygpOiBXaWRnZXRbXSB7XG4gICAgY29uc3QgcGFpcnNUb1RyYWNrRW50cmllcyA9IEFycmF5LmZyb20oUEFJUlNfVE9fVFJBQ0suZW50cmllcygpKVxuICAgIGNvbnN0IHdpZGdldHM6IFdpZGdldFtdID0gXy5mbGF0TWFwKHBhaXJzVG9UcmFja0VudHJpZXMsIChbY2hhaW5JZCwgcGFpcnNCeVRyYWRlVHlwZV0pID0+IHtcbiAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRlQ2hhcnRXaWRnZXRzRnJvbVBhaXJzQnlUcmFkZVR5cGUoY2hhaW5JZCwgcGFpcnNCeVRyYWRlVHlwZSlcbiAgICB9KVxuXG4gICAgcmV0dXJuIHdpZGdldHNcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVDaGFydFdpZGdldHNGcm9tUGFpcnNCeVRyYWRlVHlwZShcbiAgICBjaGFpbklkOiBDaGFpbklkLFxuICAgIHBhaXJzQnlUcmFkZVR5cGU6IE1hcDxUcmFkZVR5cGUsIHN0cmluZ1tdPlxuICApOiBXaWRnZXRbXSB7XG4gICAgY29uc3QgcGFpcnNCeVRyYWRlVHlwZUVudHJpZXMgPSBBcnJheS5mcm9tKHBhaXJzQnlUcmFkZVR5cGUuZW50cmllcygpKVxuXG4gICAgY29uc3Qgd2lkZ2V0cyA9IF8uZmxhdE1hcChwYWlyc0J5VHJhZGVUeXBlRW50cmllcywgKFt0cmFkZVR5cGUsIHBhaXJzXTogW1RyYWRlVHlwZSwgc3RyaW5nW11dKSA9PlxuICAgICAgdGhpcy5nZW5lcmF0ZUNoYXJ0V2lkZ2V0c0Zyb21QYWlycyhjaGFpbklkLCB0cmFkZVR5cGUsIHBhaXJzKVxuICAgIClcblxuICAgIHJldHVybiB3aWRnZXRzXG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlQ2hhcnRXaWRnZXRzRnJvbVBhaXJzKGNoYWluSWQ6IENoYWluSWQsIHRyYWRlVHlwZTogVHJhZGVUeXBlLCBwYWlyczogc3RyaW5nW10pOiBXaWRnZXRbXSB7XG4gICAgcmV0dXJuIF8uZmxhdE1hcChwYWlycywgKHBhaXI6IHN0cmluZykgPT4gdGhpcy5nZW5lcmF0ZUNoYXJ0V2lkZ2V0c0Zyb21QYWlyKGNoYWluSWQsIHRyYWRlVHlwZSwgcGFpcikpXG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlQ2hhcnRXaWRnZXRzRnJvbVBhaXIoY2hhaW5JZDogQ2hhaW5JZCwgdHJhZGVUeXBlOiBUcmFkZVR5cGUsIHBhaXI6IHN0cmluZyk6IFdpZGdldFtdIHtcbiAgICBjb25zdCB0cmFkZVR5cGVMYWJlbCA9IHRoaXMudHJhZGVUeXBlVG9TdHJpbmcodHJhZGVUeXBlKVxuICAgIGNvbnN0IHdpZGdldHM6IFdpZGdldFtdID0gW1xuICAgICAge1xuICAgICAgICB0eXBlOiAndGV4dCcsXG4gICAgICAgIHdpZHRoOiAyNCxcbiAgICAgICAgaGVpZ2h0OiAyLFxuICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgbWFya2Rvd246IGAjICR7SURfVE9fTkVUV09SS19OQU1FKGNoYWluSWQpfSAtIENoYWluSWQ6ICR7Y2hhaW5JZH1cXG4jIyAke3BhaXJ9IC0gJHt0cmFkZVR5cGVMYWJlbH1gLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgdHlwZTogJ21ldHJpYycsXG4gICAgICAgIHdpZHRoOiAyNCxcbiAgICAgICAgaGVpZ2h0OiA2LFxuICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgdmlldzogJ3RpbWVTZXJpZXMnLFxuICAgICAgICAgIHN0YWNrZWQ6IGZhbHNlLFxuICAgICAgICAgIG1ldHJpY3M6IFtcbiAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgdGhpcy5uYW1lc3BhY2UsXG4gICAgICAgICAgICAgIGBHRVRfUVVPVEVfQU1PVU5UXyR7cGFpcn1fJHt0cmFkZVR5cGVMYWJlbC50b1VwcGVyQ2FzZSgpfV9DSEFJTl8ke2NoYWluSWR9YCxcbiAgICAgICAgICAgICAgJ1NlcnZpY2UnLFxuICAgICAgICAgICAgICAnUm91dGluZ0FQSScsXG4gICAgICAgICAgICAgIHsgbGFiZWw6IGAke3BhaXJ9LyR7dHJhZGVUeXBlTGFiZWwudG9VcHBlckNhc2UoKX0gUXVvdGVzYCB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICBdLFxuICAgICAgICAgIHJlZ2lvbjogdGhpcy5yZWdpb24sXG4gICAgICAgICAgdGl0bGU6IGBOdW1iZXIgb2YgcmVxdWVzdGVkIHF1b3RlcyAke3BhaXJ9LyR7dHJhZGVUeXBlTGFiZWx9YCxcbiAgICAgICAgICBwZXJpb2Q6IDMwMCxcbiAgICAgICAgICBzdGF0OiAnU2FtcGxlQ291bnQnLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgdHlwZTogJ21ldHJpYycsXG4gICAgICAgIHdpZHRoOiAyNCxcbiAgICAgICAgaGVpZ2h0OiA5LFxuICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgdmlldzogJ3RpbWVTZXJpZXMnLFxuICAgICAgICAgIHN0YWNrZWQ6IHRydWUsXG4gICAgICAgICAgbWV0cmljczogW1xuICAgICAgICAgICAgW1xuICAgICAgICAgICAgICB0aGlzLm5hbWVzcGFjZSxcbiAgICAgICAgICAgICAgYEdFVF9RVU9URV9BTU9VTlRfJHtwYWlyfV8ke3RyYWRlVHlwZUxhYmVsLnRvVXBwZXJDYXNlKCl9X0NIQUlOXyR7Y2hhaW5JZH1gLFxuICAgICAgICAgICAgICAnU2VydmljZScsXG4gICAgICAgICAgICAgICdSb3V0aW5nQVBJJyxcbiAgICAgICAgICAgICAgdGhpcy5nZW5lcmF0ZVN0YXRXaXRoTGFiZWwoMCwgMSwgcGFpciwgdHJhZGVUeXBlKSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBbJy4uLicsIHRoaXMuZ2VuZXJhdGVTdGF0V2l0aExhYmVsKDEsIDUsIHBhaXIsIHRyYWRlVHlwZSldLFxuICAgICAgICAgICAgWycuLi4nLCB0aGlzLmdlbmVyYXRlU3RhdFdpdGhMYWJlbCg1LCAxMCwgcGFpciwgdHJhZGVUeXBlKV0sXG4gICAgICAgICAgICBbJy4uLicsIHRoaXMuZ2VuZXJhdGVTdGF0V2l0aExhYmVsKDEwLCA1MCwgcGFpciwgdHJhZGVUeXBlKV0sXG4gICAgICAgICAgICBbJy4uLicsIHRoaXMuZ2VuZXJhdGVTdGF0V2l0aExhYmVsKDUwLCAxMDAsIHBhaXIsIHRyYWRlVHlwZSldLFxuICAgICAgICAgICAgWycuLi4nLCB0aGlzLmdlbmVyYXRlU3RhdFdpdGhMYWJlbCgxMDAsIDUwMCwgcGFpciwgdHJhZGVUeXBlKV0sXG4gICAgICAgICAgICBbJy4uLicsIHRoaXMuZ2VuZXJhdGVTdGF0V2l0aExhYmVsKDUwMCwgMTAwMCwgcGFpciwgdHJhZGVUeXBlKV0sXG4gICAgICAgICAgICBbJy4uLicsIHRoaXMuZ2VuZXJhdGVTdGF0V2l0aExhYmVsKDEwMDAsIDUwMDAsIHBhaXIsIHRyYWRlVHlwZSldLFxuICAgICAgICAgICAgWycuLi4nLCB0aGlzLmdlbmVyYXRlU3RhdFdpdGhMYWJlbCg1MDAwLCAxMDAwMCwgcGFpciwgdHJhZGVUeXBlKV0sXG4gICAgICAgICAgICBbJy4uLicsIHRoaXMuZ2VuZXJhdGVTdGF0V2l0aExhYmVsKDEwMDAwLCA1MDAwMCwgcGFpciwgdHJhZGVUeXBlKV0sXG4gICAgICAgICAgICBbJy4uLicsIHRoaXMuZ2VuZXJhdGVTdGF0V2l0aExhYmVsKDUwMDAwLCAxMDAwMDAsIHBhaXIsIHRyYWRlVHlwZSldLFxuICAgICAgICAgICAgWycuLi4nLCB0aGlzLmdlbmVyYXRlU3RhdFdpdGhMYWJlbCgxMDAwMDAsIDUwMDAwMCwgcGFpciwgdHJhZGVUeXBlKV0sXG4gICAgICAgICAgICBbJy4uLicsIHRoaXMuZ2VuZXJhdGVTdGF0V2l0aExhYmVsKDUwMDAwMCwgMTAwMDAwMCwgcGFpciwgdHJhZGVUeXBlKV0sXG4gICAgICAgICAgICBbJy4uLicsIHRoaXMuZ2VuZXJhdGVTdGF0V2l0aExhYmVsKDEwMDAwMDAsIC0xLCBwYWlyLCB0cmFkZVR5cGUpXSxcbiAgICAgICAgICBdLFxuICAgICAgICAgIHJlZ2lvbjogdGhpcy5yZWdpb24sXG4gICAgICAgICAgdGl0bGU6IGBEaXN0cmlidXRpb24gb2YgcXVvdGVzICR7cGFpcn0vJHt0cmFkZVR5cGVMYWJlbH1gLFxuICAgICAgICAgIHBlcmlvZDogMzAwLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICBdXG5cbiAgICByZXR1cm4gd2lkZ2V0c1xuICB9XG5cbiAgcHJpdmF0ZSB0cmFkZVR5cGVUb1N0cmluZyh0cmFkZVR5cGU6IFRyYWRlVHlwZSkge1xuICAgIGlmICh0cmFkZVR5cGUgPT0gVHJhZGVUeXBlLkVYQUNUX0lOUFVUKSB7XG4gICAgICByZXR1cm4gJ0V4YWN0SW4nXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAnRXhhY3RPdXQnXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZVN0YXRXaXRoTGFiZWwoXG4gICAgbWluOiBudW1iZXIsXG4gICAgbWF4OiBudW1iZXIsXG4gICAgcGFpcjogc3RyaW5nLFxuICAgIHRyYWRlVHlwZTogVHJhZGVUeXBlXG4gICk6IHsgc3RhdDogc3RyaW5nOyBsYWJlbDogc3RyaW5nIH0ge1xuICAgIGNvbnN0IHRva2VucyA9IHBhaXIuc3BsaXQoJy8nKVxuICAgIGNvbnN0IG1heE5vcm1hbGl6ZWQgPSBtYXggPiAwID8gbWF4LnRvU3RyaW5nKCkgOiAnJ1xuXG4gICAgc3dpdGNoICh0cmFkZVR5cGUpIHtcbiAgICAgIGNhc2UgVHJhZGVUeXBlLkVYQUNUX0lOUFVUOlxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN0YXQ6IGBQUigke21pbn06JHttYXhOb3JtYWxpemVkfSlgLFxuICAgICAgICAgIGxhYmVsOiBgJHttaW59IHRvICR7bWF4fSAke3Rva2Vuc1swXX1gLFxuICAgICAgICB9XG4gICAgICBjYXNlIFRyYWRlVHlwZS5FWEFDVF9PVVRQVVQ6XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3RhdDogYFBSKCR7bWlufToke21heE5vcm1hbGl6ZWR9KWAsXG4gICAgICAgICAgbGFiZWw6IGAke21pbn0gdG8gJHttYXh9ICR7dG9rZW5zWzFdfWAsXG4gICAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiJdfQ==