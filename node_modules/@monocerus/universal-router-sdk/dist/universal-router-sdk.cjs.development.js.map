{"version":3,"file":"universal-router-sdk.cjs.development.js","sources":["../src/entities/Command.ts","../src/entities/NFTTrade.ts","../src/utils/routerCommands.ts","../src/utils/constants.ts","../src/entities/protocols/uniswap.ts","../src/utils/inputTokens.ts","../src/swapRouter.ts","../src/entities/protocols/cryptopunk.ts","../src/entities/protocols/foundation.ts","../src/entities/protocols/looksRareV2.ts","../src/entities/protocols/nft20.ts","../src/entities/protocols/nftx.ts","../src/entities/protocols/seaport.ts","../src/entities/protocols/sudoswap.ts","../src/entities/protocols/x2y2.ts","../src/entities/protocols/unwrapWETH.ts"],"sourcesContent":["import { RoutePlanner } from '../utils/routerCommands'\r\n\r\nexport type TradeConfig = {\r\n  allowRevert: boolean\r\n}\r\n\r\nexport enum RouterTradeType {\r\n  UniswapTrade = 'UniswapTrade',\r\n  NFTTrade = 'NFTTrade',\r\n  UnwrapWETH = 'UnwrapWETH',\r\n}\r\n\r\n// interface for entities that can be encoded as a Universal Router command\r\nexport interface Command {\r\n  tradeType: RouterTradeType\r\n  encode(planner: RoutePlanner, config: TradeConfig): void\r\n}\r\n","import invariant from 'tiny-invariant'\r\nimport { BigNumber, BigNumberish } from 'ethers'\r\nimport { SeaportData } from './protocols/seaport'\r\nimport { FoundationData } from './protocols/foundation'\r\nimport { NFTXData } from './protocols/nftx'\r\nimport { NFT20Data } from './protocols/nft20'\r\nimport { RoutePlanner } from '../utils/routerCommands'\r\nimport { Command, RouterTradeType, TradeConfig } from './Command'\r\nimport { SudoswapData } from './protocols/sudoswap'\r\nimport { CryptopunkData } from './protocols/cryptopunk'\r\nimport { X2Y2Data } from './protocols/x2y2'\r\nimport { ElementData } from './protocols/element-market'\r\nimport { LooksRareV2Data } from './protocols/looksRareV2'\r\n\r\nexport type SupportedProtocolsData =\r\n  | SeaportData\r\n  | FoundationData\r\n  | NFTXData\r\n  | LooksRareV2Data\r\n  | X2Y2Data\r\n  | CryptopunkData\r\n  | NFT20Data\r\n  | SudoswapData\r\n  | ElementData\r\n\r\nexport abstract class NFTTrade<T> implements Command {\r\n  readonly tradeType: RouterTradeType = RouterTradeType.NFTTrade\r\n  readonly orders: T[]\r\n  readonly market: Market\r\n\r\n  constructor(market: Market, orders: T[]) {\r\n    invariant(orders.length > 0, 'no buy Items')\r\n    this.market = market\r\n    this.orders = orders\r\n  }\r\n\r\n  abstract encode(planner: RoutePlanner, config: TradeConfig): void\r\n\r\n  abstract getBuyItems(): BuyItem[]\r\n\r\n  // optional parameter for the markets that accept ERC20s not just ETH\r\n  abstract getTotalPrice(token?: string): BigNumber\r\n}\r\n\r\nexport type BuyItem = {\r\n  tokenAddress: string\r\n  tokenId: BigNumberish\r\n  tokenType: TokenType\r\n  amount?: BigNumberish // for 1155\r\n}\r\n\r\nexport enum Market {\r\n  Foundation = 'foundation',\r\n  LooksRareV2 = 'looksrareV2',\r\n  NFT20 = 'nft20',\r\n  NFTX = 'nftx',\r\n  Seaport = 'seaport',\r\n  Sudoswap = 'Sudoswap',\r\n  Cryptopunks = 'cryptopunks',\r\n  X2Y2 = 'x2y2',\r\n  Element = 'element',\r\n}\r\n\r\nexport enum TokenType {\r\n  ERC721 = 'ERC721',\r\n  ERC1155 = 'ERC1155',\r\n  Cryptopunk = 'Cryptopunk',\r\n}\r\n","import { defaultAbiCoder } from 'ethers/lib/utils'\r\n\r\n/**\r\n * CommandTypes\r\n * @description Flags that modify a command's execution\r\n * @enum {number}\r\n */\r\nexport enum CommandType {\r\n  V3_SWAP_EXACT_IN = 0x00,\r\n  V3_SWAP_EXACT_OUT = 0x01,\r\n  PERMIT2_TRANSFER_FROM = 0x02,\r\n  PERMIT2_PERMIT_BATCH = 0x03,\r\n  SWEEP = 0x04,\r\n  TRANSFER = 0x05,\r\n  PAY_PORTION = 0x06,\r\n\r\n  V2_SWAP_EXACT_IN = 0x08,\r\n  V2_SWAP_EXACT_OUT = 0x09,\r\n  PERMIT2_PERMIT = 0x0a,\r\n  WRAP_ETH = 0x0b,\r\n  UNWRAP_WETH = 0x0c,\r\n  PERMIT2_TRANSFER_FROM_BATCH = 0x0d,\r\n  BALANCE_CHECK_ERC20 = 0x0e,\r\n\r\n  // NFT-related command types\r\n  SEAPORT_V1_5 = 0x10,\r\n  LOOKS_RARE_V2 = 0x11,\r\n  NFTX = 0x12,\r\n  CRYPTOPUNKS = 0x13,\r\n  // 0x14\r\n  OWNER_CHECK_721 = 0x15,\r\n  OWNER_CHECK_1155 = 0x16,\r\n  SWEEP_ERC721 = 0x17,\r\n\r\n  X2Y2_721 = 0x18,\r\n  SUDOSWAP = 0x19,\r\n  NFT20 = 0x1a,\r\n  X2Y2_1155 = 0x1b,\r\n  FOUNDATION = 0x1c,\r\n  SWEEP_ERC1155 = 0x1d,\r\n  ELEMENT_MARKET = 0x1e,\r\n\r\n  SEAPORT_V1_4 = 0x20,\r\n  EXECUTE_SUB_PLAN = 0x21,\r\n  APPROVE_ERC20 = 0x22,\r\n}\r\n\r\nconst ALLOW_REVERT_FLAG = 0x80\r\n\r\nconst REVERTIBLE_COMMANDS = new Set<CommandType>([\r\n  CommandType.SEAPORT_V1_5,\r\n  CommandType.SEAPORT_V1_4,\r\n  CommandType.NFTX,\r\n  CommandType.LOOKS_RARE_V2,\r\n  CommandType.X2Y2_721,\r\n  CommandType.X2Y2_1155,\r\n  CommandType.FOUNDATION,\r\n  CommandType.SUDOSWAP,\r\n  CommandType.NFT20,\r\n  CommandType.EXECUTE_SUB_PLAN,\r\n  CommandType.CRYPTOPUNKS,\r\n  CommandType.ELEMENT_MARKET,\r\n])\r\n\r\nconst PERMIT_STRUCT =\r\n  '((address token,uint160 amount,uint48 expiration,uint48 nonce) details,address spender,uint256 sigDeadline)'\r\n\r\nconst PERMIT_BATCH_STRUCT =\r\n  '((address token,uint160 amount,uint48 expiration,uint48 nonce)[] details,address spender,uint256 sigDeadline)'\r\n\r\nconst PERMIT2_TRANSFER_FROM_STRUCT = '(address from,address to,uint160 amount,address token)'\r\nconst PERMIT2_TRANSFER_FROM_BATCH_STRUCT = PERMIT2_TRANSFER_FROM_STRUCT + '[]'\r\n\r\nconst ABI_DEFINITION: { [key in CommandType]: string[] } = {\r\n  // Batch Reverts\r\n  [CommandType.EXECUTE_SUB_PLAN]: ['bytes', 'bytes[]'],\r\n\r\n  // Permit2 Actions\r\n  [CommandType.PERMIT2_PERMIT]: [PERMIT_STRUCT, 'bytes'],\r\n  [CommandType.PERMIT2_PERMIT_BATCH]: [PERMIT_BATCH_STRUCT, 'bytes'],\r\n  [CommandType.PERMIT2_TRANSFER_FROM]: ['address', 'address', 'uint160'],\r\n  [CommandType.PERMIT2_TRANSFER_FROM_BATCH]: [PERMIT2_TRANSFER_FROM_BATCH_STRUCT],\r\n\r\n  // Uniswap Actions\r\n  [CommandType.V3_SWAP_EXACT_IN]: ['address', 'uint256', 'uint256', 'bytes', 'bool'],\r\n  [CommandType.V3_SWAP_EXACT_OUT]: ['address', 'uint256', 'uint256', 'bytes', 'bool'],\r\n  [CommandType.V2_SWAP_EXACT_IN]: ['address', 'uint256', 'uint256', 'address[]', 'bool'],\r\n  [CommandType.V2_SWAP_EXACT_OUT]: ['address', 'uint256', 'uint256', 'address[]', 'bool'],\r\n\r\n  // Token Actions and Checks\r\n  [CommandType.WRAP_ETH]: ['address', 'uint256'],\r\n  [CommandType.UNWRAP_WETH]: ['address', 'uint256'],\r\n  [CommandType.SWEEP]: ['address', 'address', 'uint256'],\r\n  [CommandType.SWEEP_ERC721]: ['address', 'address', 'uint256'],\r\n  [CommandType.SWEEP_ERC1155]: ['address', 'address', 'uint256', 'uint256'],\r\n  [CommandType.TRANSFER]: ['address', 'address', 'uint256'],\r\n  [CommandType.PAY_PORTION]: ['address', 'address', 'uint256'],\r\n  [CommandType.BALANCE_CHECK_ERC20]: ['address', 'address', 'uint256'],\r\n  [CommandType.OWNER_CHECK_721]: ['address', 'address', 'uint256'],\r\n  [CommandType.OWNER_CHECK_1155]: ['address', 'address', 'uint256', 'uint256'],\r\n  [CommandType.APPROVE_ERC20]: ['address', 'uint256'],\r\n\r\n  // NFT Markets\r\n  [CommandType.SEAPORT_V1_5]: ['uint256', 'bytes'],\r\n  [CommandType.SEAPORT_V1_4]: ['uint256', 'bytes'],\r\n  [CommandType.NFTX]: ['uint256', 'bytes'],\r\n  [CommandType.LOOKS_RARE_V2]: ['uint256', 'bytes'],\r\n  [CommandType.X2Y2_721]: ['uint256', 'bytes', 'address', 'address', 'uint256'],\r\n  [CommandType.X2Y2_1155]: ['uint256', 'bytes', 'address', 'address', 'uint256', 'uint256'],\r\n  [CommandType.FOUNDATION]: ['uint256', 'bytes', 'address', 'address', 'uint256'],\r\n  [CommandType.SUDOSWAP]: ['uint256', 'bytes'],\r\n  [CommandType.NFT20]: ['uint256', 'bytes'],\r\n  [CommandType.CRYPTOPUNKS]: ['uint256', 'address', 'uint256'],\r\n  [CommandType.ELEMENT_MARKET]: ['uint256', 'bytes'],\r\n}\r\n\r\nexport class RoutePlanner {\r\n  commands: string\r\n  inputs: string[]\r\n\r\n  constructor() {\r\n    this.commands = '0x'\r\n    this.inputs = []\r\n  }\r\n\r\n  addSubPlan(subplan: RoutePlanner): void {\r\n    this.addCommand(CommandType.EXECUTE_SUB_PLAN, [subplan.commands, subplan.inputs], true)\r\n  }\r\n\r\n  addCommand(type: CommandType, parameters: any[], allowRevert = false): void {\r\n    let command = createCommand(type, parameters)\r\n    this.inputs.push(command.encodedInput)\r\n    if (allowRevert) {\r\n      if (!REVERTIBLE_COMMANDS.has(command.type)) {\r\n        throw new Error(`command type: ${command.type} cannot be allowed to revert`)\r\n      }\r\n      command.type = command.type | ALLOW_REVERT_FLAG\r\n    }\r\n\r\n    this.commands = this.commands.concat(command.type.toString(16).padStart(2, '0'))\r\n  }\r\n}\r\n\r\nexport type RouterCommand = {\r\n  type: CommandType\r\n  encodedInput: string\r\n}\r\n\r\nexport function createCommand(type: CommandType, parameters: any[]): RouterCommand {\r\n  const encodedInput = defaultAbiCoder.encode(ABI_DEFINITION[type], parameters)\r\n  return { type, encodedInput }\r\n}\r\n","import { BigNumber } from 'ethers'\r\n\r\nexport const UNIVERSAL_ROUTER_ADDRESS = (chainId: number): string => {\r\n  switch (chainId) {\r\n    case 1: // mainnet\r\n      return '0x3fC91A3afd70395Cd496C647d5a6CC9D4B2b7FAD'\r\n    case 169: // manta\r\n        return '0x3fC944Ef0671249B3E6835eC6da01E2124610018'\r\n    case 3441005: // manta testnet\r\n        return '0x016835cDc0DD8043f96caEC2c5C075FF787fE0AD'\r\n    default:\r\n      throw new Error(`Universal Router not deployed on chain ${chainId}`)\r\n  }\r\n}\r\n\r\nexport const WETH_ADDRESS = (chainId: number): string => {\r\n  switch (chainId) {\r\n    case 1: //mainnet\r\n      return '0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2'\r\n    case 169: // manta\r\n      return '0x0Dc808adcE2099A9F62AA87D9670745AbA741746'    \r\n    case 3441005: // manta testnet\r\n      return '0x226E0D9fBDE51708fC36Bb4E5d1af9728A285cF4'\r\n    default:\r\n      throw new Error(`WETH9 or UniversalRouter not deployed on chain ${chainId}`)\r\n  }\r\n}\r\n\r\nexport const PERMIT2_ADDRESS = '0x000000000022D473030F116dDEE9F6B43aC78BA3'\r\n\r\nexport const CONTRACT_BALANCE = BigNumber.from(2).pow(255)\r\nexport const ETH_ADDRESS = '0x0000000000000000000000000000000000000000'\r\nexport const ZERO_ADDRESS = '0x0000000000000000000000000000000000000000'\r\nexport const MAX_UINT256 = BigNumber.from(2).pow(256).sub(1)\r\nexport const MAX_UINT160 = BigNumber.from(2).pow(160).sub(1)\r\n\r\nexport const SENDER_AS_RECIPIENT = '0x0000000000000000000000000000000000000001'\r\nexport const ROUTER_AS_RECIPIENT = '0x0000000000000000000000000000000000000002'\r\n\r\nexport const OPENSEA_CONDUIT_SPENDER_ID = 0\r\nexport const SUDOSWAP_SPENDER_ID = 1\r\n","import JSBI from 'jsbi'\r\nimport { RoutePlanner, CommandType } from '../../utils/routerCommands'\r\nimport { Trade as V2Trade, Pair } from '@uniswap/v2-sdk'\r\nimport { Trade as V3Trade, Pool, encodeRouteToPath } from '@uniswap/v3-sdk'\r\nimport {\r\n  Trade as RouterTrade,\r\n  MixedRouteTrade,\r\n  Protocol,\r\n  IRoute,\r\n  RouteV2,\r\n  RouteV3,\r\n  MixedRouteSDK,\r\n  MixedRoute,\r\n  SwapOptions as RouterSwapOptions,\r\n  getOutputOfPools,\r\n  encodeMixedRouteToPath,\r\n  partitionMixedRouteByProtocol,\r\n} from '@uniswap/router-sdk'\r\nimport { Permit2Permit } from '../../utils/inputTokens'\r\nimport { Currency, TradeType, CurrencyAmount, Percent } from '@uniswap/sdk-core'\r\nimport { Command, RouterTradeType, TradeConfig } from '../Command'\r\nimport { SENDER_AS_RECIPIENT, ROUTER_AS_RECIPIENT, CONTRACT_BALANCE } from '../../utils/constants'\r\n\r\n// the existing router permit object doesn't include enough data for permit2\r\n// so we extend swap options with the permit2 permit\r\nexport type SwapOptions = Omit<RouterSwapOptions, 'inputTokenPermit'> & {\r\n  inputTokenPermit?: Permit2Permit\r\n}\r\n\r\nconst REFUND_ETH_PRICE_IMPACT_THRESHOLD = new Percent(JSBI.BigInt(50), JSBI.BigInt(100))\r\n\r\ninterface Swap<TInput extends Currency, TOutput extends Currency> {\r\n  route: IRoute<TInput, TOutput, Pair | Pool>\r\n  inputAmount: CurrencyAmount<TInput>\r\n  outputAmount: CurrencyAmount<TOutput>\r\n}\r\n\r\n// Wrapper for uniswap router-sdk trade entity to encode swaps for Universal Router\r\n// also translates trade objects from previous (v2, v3) SDKs\r\nexport class UniswapTrade implements Command {\r\n  readonly tradeType: RouterTradeType = RouterTradeType.UniswapTrade\r\n  constructor(public trade: RouterTrade<Currency, Currency, TradeType>, public options: SwapOptions) {}\r\n\r\n  encode(planner: RoutePlanner, _config: TradeConfig): void {\r\n    let payerIsUser = true\r\n    if (this.trade.inputAmount.currency.isNative) {\r\n      // TODO: optimize if only one v2 pool we can directly send this to the pool\r\n      planner.addCommand(CommandType.WRAP_ETH, [\r\n        ROUTER_AS_RECIPIENT,\r\n        this.trade.maximumAmountIn(this.options.slippageTolerance).quotient.toString(),\r\n      ])\r\n      // since WETH is now owned by the router, the router pays for inputs\r\n      payerIsUser = false\r\n    }\r\n    this.options.recipient = this.options.recipient ?? SENDER_AS_RECIPIENT\r\n\r\n    // flag for whether we want to perform slippage check on aggregate output of multiple routes\r\n    //   1. when there are >2 exact input trades. this is only a heuristic,\r\n    //      as it's still more gas-expensive even in this case, but has benefits\r\n    //      in that the reversion probability is lower\r\n    const performAggregatedSlippageCheck =\r\n      this.trade.tradeType === TradeType.EXACT_INPUT && this.trade.routes.length > 2\r\n    const outputIsNative = this.trade.outputAmount.currency.isNative\r\n    const inputIsNative = this.trade.inputAmount.currency.isNative\r\n    const routerMustCustody = performAggregatedSlippageCheck || outputIsNative\r\n\r\n    for (const swap of this.trade.swaps) {\r\n      switch (swap.route.protocol) {\r\n        case Protocol.V2:\r\n          addV2Swap(planner, swap, this.trade.tradeType, this.options, payerIsUser, routerMustCustody)\r\n          break\r\n        case Protocol.V3:\r\n          addV3Swap(planner, swap, this.trade.tradeType, this.options, payerIsUser, routerMustCustody)\r\n          break\r\n        case Protocol.MIXED:\r\n          addMixedSwap(planner, swap, this.trade.tradeType, this.options, payerIsUser, routerMustCustody)\r\n          break\r\n        default:\r\n          throw new Error('UNSUPPORTED_TRADE_PROTOCOL')\r\n      }\r\n    }\r\n\r\n    if (routerMustCustody) {\r\n      if (outputIsNative) {\r\n        planner.addCommand(CommandType.UNWRAP_WETH, [\r\n          this.options.recipient,\r\n          this.trade.minimumAmountOut(this.options.slippageTolerance).quotient.toString(),\r\n        ])\r\n      } else {\r\n        planner.addCommand(CommandType.SWEEP, [\r\n          this.trade.outputAmount.currency.wrapped.address,\r\n          this.options.recipient,\r\n          this.trade.minimumAmountOut(this.options.slippageTolerance).quotient.toString(),\r\n        ])\r\n      }\r\n    }\r\n\r\n    if (inputIsNative && (this.trade.tradeType === TradeType.EXACT_OUTPUT || riskOfPartialFill(this.trade))) {\r\n      // for exactOutput swaps that take native currency as input\r\n      // we need to send back the change to the user\r\n      planner.addCommand(CommandType.UNWRAP_WETH, [this.options.recipient, 0])\r\n    }\r\n  }\r\n}\r\n\r\n// encode a uniswap v2 swap\r\nfunction addV2Swap<TInput extends Currency, TOutput extends Currency>(\r\n  planner: RoutePlanner,\r\n  { route, inputAmount, outputAmount }: Swap<TInput, TOutput>,\r\n  tradeType: TradeType,\r\n  options: SwapOptions,\r\n  payerIsUser: boolean,\r\n  routerMustCustody: boolean\r\n): void {\r\n  const trade = new V2Trade(\r\n    route as RouteV2<TInput, TOutput>,\r\n    tradeType == TradeType.EXACT_INPUT ? inputAmount : outputAmount,\r\n    tradeType\r\n  )\r\n\r\n  if (tradeType == TradeType.EXACT_INPUT) {\r\n    planner.addCommand(CommandType.V2_SWAP_EXACT_IN, [\r\n      // if native, we have to unwrap so keep in the router for now\r\n      routerMustCustody ? ROUTER_AS_RECIPIENT : options.recipient,\r\n      trade.maximumAmountIn(options.slippageTolerance).quotient.toString(),\r\n      trade.minimumAmountOut(options.slippageTolerance).quotient.toString(),\r\n      route.path.map((pool) => pool.address),\r\n      payerIsUser,\r\n    ])\r\n  } else if (tradeType == TradeType.EXACT_OUTPUT) {\r\n    planner.addCommand(CommandType.V2_SWAP_EXACT_OUT, [\r\n      routerMustCustody ? ROUTER_AS_RECIPIENT : options.recipient,\r\n      trade.minimumAmountOut(options.slippageTolerance).quotient.toString(),\r\n      trade.maximumAmountIn(options.slippageTolerance).quotient.toString(),\r\n      route.path.map((pool) => pool.address),\r\n      payerIsUser,\r\n    ])\r\n  }\r\n}\r\n\r\n// encode a uniswap v3 swap\r\nfunction addV3Swap<TInput extends Currency, TOutput extends Currency>(\r\n  planner: RoutePlanner,\r\n  { route, inputAmount, outputAmount }: Swap<TInput, TOutput>,\r\n  tradeType: TradeType,\r\n  options: SwapOptions,\r\n  payerIsUser: boolean,\r\n  routerMustCustody: boolean\r\n): void {\r\n  const trade = V3Trade.createUncheckedTrade({\r\n    route: route as RouteV3<TInput, TOutput>,\r\n    inputAmount,\r\n    outputAmount,\r\n    tradeType,\r\n  })\r\n\r\n  const path = encodeRouteToPath(route as RouteV3<TInput, TOutput>, trade.tradeType === TradeType.EXACT_OUTPUT)\r\n  if (tradeType == TradeType.EXACT_INPUT) {\r\n    planner.addCommand(CommandType.V3_SWAP_EXACT_IN, [\r\n      routerMustCustody ? ROUTER_AS_RECIPIENT : options.recipient,\r\n      trade.maximumAmountIn(options.slippageTolerance).quotient.toString(),\r\n      trade.minimumAmountOut(options.slippageTolerance).quotient.toString(),\r\n      path,\r\n      payerIsUser,\r\n    ])\r\n  } else if (tradeType == TradeType.EXACT_OUTPUT) {\r\n    planner.addCommand(CommandType.V3_SWAP_EXACT_OUT, [\r\n      routerMustCustody ? ROUTER_AS_RECIPIENT : options.recipient,\r\n      trade.minimumAmountOut(options.slippageTolerance).quotient.toString(),\r\n      trade.maximumAmountIn(options.slippageTolerance).quotient.toString(),\r\n      path,\r\n      payerIsUser,\r\n    ])\r\n  }\r\n}\r\n\r\n// encode a mixed route swap, i.e. including both v2 and v3 pools\r\nfunction addMixedSwap<TInput extends Currency, TOutput extends Currency>(\r\n  planner: RoutePlanner,\r\n  swap: Swap<TInput, TOutput>,\r\n  tradeType: TradeType,\r\n  options: SwapOptions,\r\n  payerIsUser: boolean,\r\n  routerMustCustody: boolean\r\n): void {\r\n  const { route, inputAmount, outputAmount } = swap\r\n  const tradeRecipient = routerMustCustody ? ROUTER_AS_RECIPIENT : options.recipient\r\n\r\n  // single hop, so it can be reduced to plain v2 or v3 swap logic\r\n  if (route.pools.length === 1) {\r\n    if (route.pools[0] instanceof Pool) {\r\n      return addV3Swap(planner, swap, tradeType, options, payerIsUser, routerMustCustody)\r\n    } else if (route.pools[0] instanceof Pair) {\r\n      return addV2Swap(planner, swap, tradeType, options, payerIsUser, routerMustCustody)\r\n    } else {\r\n      throw new Error('Invalid route type')\r\n    }\r\n  }\r\n\r\n  const trade = MixedRouteTrade.createUncheckedTrade({\r\n    route: route as MixedRoute<TInput, TOutput>,\r\n    inputAmount,\r\n    outputAmount,\r\n    tradeType,\r\n  })\r\n\r\n  const amountIn = trade.maximumAmountIn(options.slippageTolerance, inputAmount).quotient.toString()\r\n  const amountOut = trade.minimumAmountOut(options.slippageTolerance, outputAmount).quotient.toString()\r\n\r\n  // logic from\r\n  // https://github.com/Uniswap/router-sdk/blob/d8eed164e6c79519983844ca8b6a3fc24ebcb8f8/src/swapRouter.ts#L276\r\n  const sections = partitionMixedRouteByProtocol(route as MixedRoute<TInput, TOutput>)\r\n  const isLastSectionInRoute = (i: number) => {\r\n    return i === sections.length - 1\r\n  }\r\n\r\n  let outputToken\r\n  let inputToken = route.input.wrapped\r\n\r\n  for (let i = 0; i < sections.length; i++) {\r\n    const section = sections[i]\r\n    /// Now, we get output of this section\r\n    outputToken = getOutputOfPools(section, inputToken)\r\n\r\n    const newRouteOriginal = new MixedRouteSDK(\r\n      [...section],\r\n      section[0].token0.equals(inputToken) ? section[0].token0 : section[0].token1,\r\n      outputToken\r\n    )\r\n    const newRoute = new MixedRoute(newRouteOriginal)\r\n\r\n    /// Previous output is now input\r\n    inputToken = outputToken\r\n\r\n    const mixedRouteIsAllV3 = (route: MixedRouteSDK<Currency, Currency>) => {\r\n      return route.pools.every((pool) => pool instanceof Pool)\r\n    }\r\n\r\n    if (mixedRouteIsAllV3(newRoute)) {\r\n      const path: string = encodeMixedRouteToPath(newRoute)\r\n\r\n      planner.addCommand(CommandType.V3_SWAP_EXACT_IN, [\r\n        // if not last section: send tokens directly to the first v2 pair of the next section\r\n        // note: because of the partitioning function we can be sure that the next section is v2\r\n        isLastSectionInRoute(i) ? tradeRecipient : (sections[i + 1][0] as Pair).liquidityToken.address,\r\n        i == 0 ? amountIn : CONTRACT_BALANCE, // amountIn\r\n        !isLastSectionInRoute(i) ? 0 : amountOut, // amountOut\r\n        path, // path\r\n        payerIsUser && i === 0, // payerIsUser\r\n      ])\r\n    } else {\r\n      planner.addCommand(CommandType.V2_SWAP_EXACT_IN, [\r\n        isLastSectionInRoute(i) ? tradeRecipient : ROUTER_AS_RECIPIENT, // recipient\r\n        i === 0 ? amountIn : CONTRACT_BALANCE, // amountIn\r\n        !isLastSectionInRoute(i) ? 0 : amountOut, // amountOutMin\r\n        newRoute.path.map((pool) => pool.address), // path\r\n        payerIsUser && i === 0,\r\n      ])\r\n    }\r\n  }\r\n}\r\n\r\n// if price impact is very high, there's a chance of hitting max/min prices resulting in a partial fill of the swap\r\nfunction riskOfPartialFill(trade: RouterTrade<Currency, Currency, TradeType>): boolean {\r\n  return trade.priceImpact.greaterThan(REFUND_ETH_PRICE_IMPACT_THRESHOLD)\r\n}\r\n","import invariant from 'tiny-invariant'\r\nimport { ethers } from 'ethers'\r\nimport { PermitSingle } from '@uniswap/permit2-sdk'\r\nimport { CommandType, RoutePlanner } from './routerCommands'\r\nimport { OPENSEA_CONDUIT_SPENDER_ID, ROUTER_AS_RECIPIENT, SUDOSWAP_SPENDER_ID } from './constants'\r\n\r\nexport interface Permit2Permit extends PermitSingle {\r\n  signature: string\r\n}\r\n\r\nexport type ApproveProtocol = {\r\n  token: string\r\n  protocol: string\r\n}\r\n\r\nexport type Permit2TransferFrom = {\r\n  token: string\r\n  amount: string\r\n  recipient?: string\r\n}\r\n\r\nexport type InputTokenOptions = {\r\n  approval?: ApproveProtocol\r\n  permit2Permit?: Permit2Permit\r\n  permit2TransferFrom?: Permit2TransferFrom\r\n}\r\n\r\nconst SIGNATURE_LENGTH = 65\r\nconst EIP_2098_SIGNATURE_LENGTH = 64\r\n\r\nexport function encodePermit(planner: RoutePlanner, permit2: Permit2Permit): void {\r\n  let signature = permit2.signature\r\n\r\n  const length = ethers.utils.arrayify(permit2.signature).length\r\n  // signature data provided for EIP-1271 may have length different from ECDSA signature\r\n  if (length === SIGNATURE_LENGTH || length === EIP_2098_SIGNATURE_LENGTH) {\r\n    // sanitizes signature to cover edge cases of malformed EIP-2098 sigs and v used as recovery id\r\n    signature = ethers.utils.joinSignature(ethers.utils.splitSignature(permit2.signature))\r\n  }\r\n\r\n  planner.addCommand(CommandType.PERMIT2_PERMIT, [permit2, signature])\r\n}\r\n\r\n// Handles the encoding of commands needed to gather input tokens for a trade\r\n// Approval: The router approving another address to take tokens.\r\n//   note: Only seaport and sudoswap support this action. Approvals are left open.\r\n// Permit: A Permit2 signature-based Permit to allow the router to access a user's tokens\r\n// Transfer: A Permit2 TransferFrom of tokens from a user to either the router or another address\r\nexport function encodeInputTokenOptions(planner: RoutePlanner, options: InputTokenOptions) {\r\n  // first ensure that all tokens provided for encoding are the same\r\n  if (!!options.approval && !!options.permit2Permit)\r\n    invariant(options.approval.token === options.permit2Permit.details.token, `inconsistent token`)\r\n  if (!!options.approval && !!options.permit2TransferFrom)\r\n    invariant(options.approval.token === options.permit2TransferFrom.token, `inconsistent token`)\r\n  if (!!options.permit2TransferFrom && !!options.permit2Permit)\r\n    invariant(options.permit2TransferFrom.token === options.permit2Permit.details.token, `inconsistent token`)\r\n\r\n  // if an options.approval is required, add it\r\n  if (!!options.approval) {\r\n    planner.addCommand(CommandType.APPROVE_ERC20, [\r\n      options.approval.token,\r\n      mapApprovalProtocol(options.approval.protocol),\r\n    ])\r\n  }\r\n\r\n  // if this order has a options.permit2Permit, encode it\r\n  if (!!options.permit2Permit) {\r\n    encodePermit(planner, options.permit2Permit)\r\n  }\r\n\r\n  if (!!options.permit2TransferFrom) {\r\n    planner.addCommand(CommandType.PERMIT2_TRANSFER_FROM, [\r\n      options.permit2TransferFrom.token,\r\n      options.permit2TransferFrom.recipient ? options.permit2TransferFrom.recipient : ROUTER_AS_RECIPIENT,\r\n      options.permit2TransferFrom.amount,\r\n    ])\r\n  }\r\n}\r\n\r\nfunction mapApprovalProtocol(protocolAddress: string): number {\r\n  switch (protocolAddress.toLowerCase()) {\r\n    case '0x00000000000000adc04c56bf30ac9d3c0aaf14dc': // Seaport v1.5\r\n      return OPENSEA_CONDUIT_SPENDER_ID\r\n    case '0x00000000000001ad428e4906ae43d8f9852d0dd6': // Seaport v1.4\r\n      return OPENSEA_CONDUIT_SPENDER_ID\r\n    case '0x2b2e8cda09bba9660dca5cb6233787738ad68329': // Sudoswap\r\n      return SUDOSWAP_SPENDER_ID\r\n    default:\r\n      throw new Error('unsupported protocol address')\r\n  }\r\n}\r\n","import invariant from 'tiny-invariant'\r\nimport { abi } from '@uniswap/universal-router/artifacts/contracts/UniversalRouter.sol/UniversalRouter.json'\r\nimport { Interface } from '@ethersproject/abi'\r\nimport { BigNumber, BigNumberish } from 'ethers'\r\nimport { MethodParameters } from '@uniswap/v3-sdk'\r\nimport { Trade as RouterTrade } from '@uniswap/router-sdk'\r\nimport { Currency, TradeType } from '@uniswap/sdk-core'\r\nimport { Command, RouterTradeType } from './entities/Command'\r\nimport { Market, NFTTrade, SupportedProtocolsData } from './entities/NFTTrade'\r\nimport { UniswapTrade, SwapOptions } from './entities/protocols/uniswap'\r\nimport { UnwrapWETH } from './entities/protocols/unwrapWETH'\r\nimport { CommandType, RoutePlanner } from './utils/routerCommands'\r\nimport { encodePermit } from './utils/inputTokens'\r\nimport { ROUTER_AS_RECIPIENT, SENDER_AS_RECIPIENT, ETH_ADDRESS } from './utils/constants'\r\nimport { SeaportTrade } from './entities'\r\n\r\nexport type SwapRouterConfig = {\r\n  sender?: string // address\r\n  deadline?: BigNumberish\r\n}\r\n\r\ntype SupportedNFTTrade = NFTTrade<SupportedProtocolsData>\r\n\r\nexport abstract class SwapRouter {\r\n  public static INTERFACE: Interface = new Interface(abi)\r\n\r\n  public static swapCallParameters(trades: Command[] | Command, config: SwapRouterConfig = {}): MethodParameters {\r\n    if (!Array.isArray(trades)) trades = [trades]\r\n\r\n    const nftTrades = trades.filter((trade, _, []) => trade.hasOwnProperty('market')) as SupportedNFTTrade[]\r\n    const allowRevert = nftTrades.length == 1 && nftTrades[0].orders.length == 1 ? false : true\r\n    const planner = new RoutePlanner()\r\n\r\n    // track value flow to require the right amount of native value\r\n    let currentNativeValueInRouter = BigNumber.from(0)\r\n    let transactionValue = BigNumber.from(0)\r\n\r\n    // tracks the input tokens (and ETH) used to buy NFTs to allow us to sweep\r\n    let nftInputTokens = new Set<string>()\r\n\r\n    for (const trade of trades) {\r\n      /**\r\n       * is NFTTrade\r\n       */\r\n      if (trade.tradeType == RouterTradeType.NFTTrade) {\r\n        const nftTrade = trade as SupportedNFTTrade\r\n        nftTrade.encode(planner, { allowRevert })\r\n        const tradePrice = nftTrade.getTotalPrice()\r\n\r\n        if (nftTrade.market == Market.Seaport) {\r\n          const seaportTrade = nftTrade as SeaportTrade\r\n          const seaportInputTokens = seaportTrade.getInputTokens()\r\n          seaportInputTokens.forEach((inputToken) => {\r\n            nftInputTokens.add(inputToken)\r\n          })\r\n        } else {\r\n          nftInputTokens.add(ETH_ADDRESS)\r\n        }\r\n\r\n        // send enough native value to contract for NFT purchase\r\n        if (currentNativeValueInRouter.lt(tradePrice)) {\r\n          transactionValue = transactionValue.add(tradePrice.sub(currentNativeValueInRouter))\r\n          currentNativeValueInRouter = BigNumber.from(0)\r\n        } else {\r\n          currentNativeValueInRouter = currentNativeValueInRouter.sub(tradePrice)\r\n        }\r\n        /**\r\n         * is UniswapTrade\r\n         */\r\n      } else if (trade.tradeType == RouterTradeType.UniswapTrade) {\r\n        const uniswapTrade = trade as UniswapTrade\r\n        const inputIsNative = uniswapTrade.trade.inputAmount.currency.isNative\r\n        const outputIsNative = uniswapTrade.trade.outputAmount.currency.isNative\r\n        const swapOptions = uniswapTrade.options\r\n\r\n        invariant(!(inputIsNative && !!swapOptions.inputTokenPermit), 'NATIVE_INPUT_PERMIT')\r\n\r\n        if (!!swapOptions.inputTokenPermit) {\r\n          encodePermit(planner, swapOptions.inputTokenPermit)\r\n        }\r\n\r\n        if (inputIsNative) {\r\n          transactionValue = transactionValue.add(\r\n            BigNumber.from(uniswapTrade.trade.maximumAmountIn(swapOptions.slippageTolerance).quotient.toString())\r\n          )\r\n        }\r\n        // track amount of native currency in the router\r\n        if (outputIsNative && swapOptions.recipient == ROUTER_AS_RECIPIENT) {\r\n          currentNativeValueInRouter = currentNativeValueInRouter.add(\r\n            BigNumber.from(uniswapTrade.trade.minimumAmountOut(swapOptions.slippageTolerance).quotient.toString())\r\n          )\r\n        }\r\n        uniswapTrade.encode(planner, { allowRevert: false })\r\n        /**\r\n         * is UnwrapWETH\r\n         */\r\n      } else if (trade.tradeType == RouterTradeType.UnwrapWETH) {\r\n        const UnwrapWETH = trade as UnwrapWETH\r\n        trade.encode(planner, { allowRevert: false })\r\n        currentNativeValueInRouter = currentNativeValueInRouter.add(UnwrapWETH.amount)\r\n        /**\r\n         * else\r\n         */\r\n      } else {\r\n        throw 'trade must be of instance: UniswapTrade or NFTTrade'\r\n      }\r\n    }\r\n\r\n    // TODO: matches current logic for now, but should eventually only sweep for multiple NFT trades\r\n    // or NFT trades with potential slippage (i.e. sudo).\r\n    // Note: NFTXV2 sends excess ETH to the caller (router), not the specified recipient\r\n    nftInputTokens.forEach((inputToken) => {\r\n      planner.addCommand(CommandType.SWEEP, [inputToken, SENDER_AS_RECIPIENT, 0])\r\n    })\r\n    return SwapRouter.encodePlan(planner, transactionValue, config)\r\n  }\r\n\r\n  /**\r\n   * @deprecated in favor of swapCallParameters. Update before next major version 2.0.0\r\n   * This version does not work correctly for Seaport ERC20->NFT purchases\r\n   * Produces the on-chain method name to call and the hex encoded parameters to pass as arguments for a given swap.\r\n   * @param trades to produce call parameters for\r\n   */\r\n  public static swapNFTCallParameters(trades: SupportedNFTTrade[], config: SwapRouterConfig = {}): MethodParameters {\r\n    let planner = new RoutePlanner()\r\n    let totalPrice = BigNumber.from(0)\r\n\r\n    const allowRevert = trades.length == 1 && trades[0].orders.length == 1 ? false : true\r\n\r\n    for (const trade of trades) {\r\n      trade.encode(planner, { allowRevert })\r\n      totalPrice = totalPrice.add(trade.getTotalPrice())\r\n    }\r\n\r\n    planner.addCommand(CommandType.SWEEP, [ETH_ADDRESS, SENDER_AS_RECIPIENT, 0])\r\n    return SwapRouter.encodePlan(planner, totalPrice, config)\r\n  }\r\n\r\n  /**\r\n   * @deprecated in favor of swapCallParameters. Update before next major version 2.0.0\r\n   * Produces the on-chain method name to call and the hex encoded parameters to pass as arguments for a given trade.\r\n   * @param trades to produce call parameters for\r\n   * @param options options for the call parameters\r\n   */\r\n  public static swapERC20CallParameters(\r\n    trades: RouterTrade<Currency, Currency, TradeType>,\r\n    options: SwapOptions\r\n  ): MethodParameters {\r\n    // TODO: use permit if signature included in swapOptions\r\n    const planner = new RoutePlanner()\r\n\r\n    const trade: UniswapTrade = new UniswapTrade(trades, options)\r\n\r\n    const inputCurrency = trade.trade.inputAmount.currency\r\n    invariant(!(inputCurrency.isNative && !!options.inputTokenPermit), 'NATIVE_INPUT_PERMIT')\r\n\r\n    if (options.inputTokenPermit) {\r\n      encodePermit(planner, options.inputTokenPermit)\r\n    }\r\n\r\n    const nativeCurrencyValue = inputCurrency.isNative\r\n      ? BigNumber.from(trade.trade.maximumAmountIn(options.slippageTolerance).quotient.toString())\r\n      : BigNumber.from(0)\r\n\r\n    trade.encode(planner, { allowRevert: false })\r\n    return SwapRouter.encodePlan(planner, nativeCurrencyValue, {\r\n      deadline: options.deadlineOrPreviousBlockhash ? BigNumber.from(options.deadlineOrPreviousBlockhash) : undefined,\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Encodes a planned route into a method name and parameters for the Router contract.\r\n   * @param planner the planned route\r\n   * @param nativeCurrencyValue the native currency value of the planned route\r\n   * @param config the router config\r\n   */\r\n  private static encodePlan(\r\n    planner: RoutePlanner,\r\n    nativeCurrencyValue: BigNumber,\r\n    config: SwapRouterConfig = {}\r\n  ): MethodParameters {\r\n    const { commands, inputs } = planner\r\n    const functionSignature = !!config.deadline ? 'execute(bytes,bytes[],uint256)' : 'execute(bytes,bytes[])'\r\n    const parameters = !!config.deadline ? [commands, inputs, config.deadline] : [commands, inputs]\r\n    const calldata = SwapRouter.INTERFACE.encodeFunctionData(functionSignature, parameters)\r\n    return { calldata, value: nativeCurrencyValue.toHexString() }\r\n  }\r\n}\r\n","import { TradeConfig } from '../Command'\r\nimport { NFTTrade, Market, TokenType, BuyItem } from '../NFTTrade'\r\nimport { RoutePlanner, CommandType } from '../../utils/routerCommands'\r\nimport { BigNumber, BigNumberish } from 'ethers'\r\n\r\nexport type CryptopunkData = {\r\n  tokenId: BigNumberish\r\n  recipient: string\r\n  value: BigNumberish\r\n}\r\n\r\nexport class CryptopunkTrade extends NFTTrade<CryptopunkData> {\r\n  public static CRYPTOPUNK_ADDRESS: string = '0xb47e3cd837ddf8e4c57f05d70ab865de6e193bbb'\r\n\r\n  constructor(orders: CryptopunkData[]) {\r\n    super(Market.Cryptopunks, orders)\r\n  }\r\n\r\n  encode(planner: RoutePlanner, config: TradeConfig): void {\r\n    for (const item of this.orders) {\r\n      planner.addCommand(CommandType.CRYPTOPUNKS, [item.tokenId, item.recipient, item.value], config.allowRevert)\r\n    }\r\n  }\r\n\r\n  getBuyItems(): BuyItem[] {\r\n    let buyItems: BuyItem[] = []\r\n    for (const item of this.orders) {\r\n      buyItems.push({\r\n        tokenAddress: CryptopunkTrade.CRYPTOPUNK_ADDRESS,\r\n        tokenId: item.tokenId,\r\n        tokenType: TokenType.Cryptopunk,\r\n      })\r\n    }\r\n    return buyItems\r\n  }\r\n\r\n  getTotalPrice(): BigNumber {\r\n    let total = BigNumber.from(0)\r\n    for (const item of this.orders) {\r\n      total = total.add(item.value)\r\n    }\r\n    return total\r\n  }\r\n}\r\n","import abi from '../../../abis/Foundation.json'\r\nimport { Interface } from '@ethersproject/abi'\r\nimport { BuyItem, Market, NFTTrade, TokenType } from '../NFTTrade'\r\nimport { TradeConfig } from '../Command'\r\nimport { RoutePlanner, CommandType } from '../../utils/routerCommands'\r\nimport { BigNumber, BigNumberish } from 'ethers'\r\n\r\nexport type FoundationData = {\r\n  recipient: string\r\n  tokenAddress: string\r\n  tokenId: BigNumberish\r\n  price: BigNumberish\r\n  referrer: string // address\r\n}\r\n\r\nexport class FoundationTrade extends NFTTrade<FoundationData> {\r\n  public static INTERFACE: Interface = new Interface(abi)\r\n\r\n  constructor(orders: FoundationData[]) {\r\n    super(Market.Foundation, orders)\r\n  }\r\n\r\n  encode(planner: RoutePlanner, config: TradeConfig): void {\r\n    for (const item of this.orders) {\r\n      const calldata = FoundationTrade.INTERFACE.encodeFunctionData('buyV2', [\r\n        item.tokenAddress,\r\n        item.tokenId,\r\n        item.price,\r\n        item.referrer,\r\n      ])\r\n      planner.addCommand(\r\n        CommandType.FOUNDATION,\r\n        [item.price, calldata, item.recipient, item.tokenAddress, item.tokenId],\r\n        config.allowRevert\r\n      )\r\n    }\r\n  }\r\n\r\n  getBuyItems(): BuyItem[] {\r\n    let buyItems: BuyItem[] = []\r\n    for (const item of this.orders) {\r\n      buyItems.push({\r\n        tokenAddress: item.tokenAddress,\r\n        tokenId: item.tokenId,\r\n        tokenType: TokenType.ERC721,\r\n      })\r\n    }\r\n    return buyItems\r\n  }\r\n\r\n  getTotalPrice(): BigNumber {\r\n    let total = BigNumber.from(0)\r\n    for (const item of this.orders) {\r\n      total = total.add(item.price)\r\n    }\r\n    return total\r\n  }\r\n}\r\n","import abi from '../../../abis/LooksRareV2.json'\r\nimport { Interface } from '@ethersproject/abi'\r\nimport { BuyItem, Market, NFTTrade, TokenType } from '../NFTTrade'\r\nimport { TradeConfig } from '../Command'\r\nimport { RoutePlanner, CommandType } from '../../utils/routerCommands'\r\nimport { BigNumber } from 'ethers'\r\nimport { ZERO_ADDRESS } from '../../utils/constants'\r\n\r\nexport type MakerOrder = {\r\n  quoteType: number\r\n  globalNonce: string\r\n  subsetNonce: string\r\n  orderNonce: string\r\n  strategyId: number\r\n  collectionType: number\r\n  collection: string\r\n  currency: string\r\n  signer: string\r\n  startTime: number\r\n  endTime: number\r\n  price: string\r\n  itemIds: string[]\r\n  amounts: string[]\r\n  additionalParameters: string\r\n}\r\n\r\nexport type TakerOrder = {\r\n  recipient: string\r\n  additionalParameters: string\r\n}\r\n\r\nexport type MerkleProof = {\r\n  value: string\r\n  position: number\r\n}\r\n\r\nexport type MerkleTree = {\r\n  root: string\r\n  proof: MerkleProof[]\r\n}\r\n\r\nexport type LRV2APIOrder = MakerOrder & {\r\n  id: string\r\n  hash: string\r\n  signature: string\r\n  createdAt: string\r\n  merkleRoot?: string\r\n  merkleProof?: MerkleProof[]\r\n  status: string\r\n}\r\n\r\nexport type LooksRareV2Data = {\r\n  apiOrder: LRV2APIOrder\r\n  taker: string\r\n}\r\n\r\nexport class LooksRareV2Trade extends NFTTrade<LooksRareV2Data> {\r\n  public static INTERFACE: Interface = new Interface(abi)\r\n  private static ERC721_ORDER = 0\r\n\r\n  constructor(orders: LooksRareV2Data[]) {\r\n    super(Market.LooksRareV2, orders)\r\n  }\r\n\r\n  encode(planner: RoutePlanner, config: TradeConfig): void {\r\n    const { takerBids, makerOrders, makerSignatures, totalValue, merkleTrees } = this.refactorAPIData(this.orders)\r\n\r\n    let calldata\r\n    if (this.orders.length == 1) {\r\n      calldata = LooksRareV2Trade.INTERFACE.encodeFunctionData('executeTakerBid', [\r\n        takerBids[0],\r\n        makerOrders[0],\r\n        makerSignatures[0],\r\n        merkleTrees[0],\r\n        ZERO_ADDRESS, // affiliate\r\n      ])\r\n    } else {\r\n      calldata = LooksRareV2Trade.INTERFACE.encodeFunctionData('executeMultipleTakerBids', [\r\n        takerBids,\r\n        makerOrders,\r\n        makerSignatures,\r\n        merkleTrees,\r\n        ZERO_ADDRESS, // affiliate\r\n        false, // isAtomic (we deal with this in allowRevert)\r\n      ])\r\n    }\r\n\r\n    planner.addCommand(CommandType.LOOKS_RARE_V2, [totalValue, calldata], config.allowRevert)\r\n  }\r\n\r\n  getBuyItems(): BuyItem[] {\r\n    let buyItems: BuyItem[] = []\r\n    for (const item of this.orders) {\r\n      const tokenAddress = item.apiOrder.collection\r\n      const tokenType =\r\n        item.apiOrder.collectionType == LooksRareV2Trade.ERC721_ORDER ? TokenType.ERC721 : TokenType.ERC1155\r\n      for (const tokenId of item.apiOrder.itemIds)\r\n        buyItems.push({\r\n          tokenAddress,\r\n          tokenId,\r\n          tokenType,\r\n        })\r\n    }\r\n    return buyItems\r\n  }\r\n\r\n  getTotalPrice(): BigNumber {\r\n    let total = BigNumber.from(0)\r\n    for (const item of this.orders) {\r\n      total = total.add(item.apiOrder.price)\r\n    }\r\n    return total\r\n  }\r\n\r\n  private refactorAPIData(orders: LooksRareV2Data[]): {\r\n    takerBids: TakerOrder[]\r\n    makerOrders: MakerOrder[]\r\n    makerSignatures: string[]\r\n    totalValue: BigNumber\r\n    merkleTrees: MerkleTree[]\r\n  } {\r\n    let takerBids: TakerOrder[] = []\r\n    let makerOrders: MakerOrder[] = []\r\n    let makerSignatures: string[] = []\r\n    let totalValue: BigNumber = BigNumber.from(0)\r\n    let merkleTrees: MerkleTree[] = []\r\n\r\n    orders.forEach((order) => {\r\n      makerOrders.push({ ...order.apiOrder })\r\n\r\n      makerSignatures.push(order.apiOrder.signature)\r\n\r\n      takerBids.push({\r\n        recipient: order.taker,\r\n        additionalParameters: '0x',\r\n      })\r\n\r\n      totalValue = totalValue.add(BigNumber.from(order.apiOrder.price))\r\n\r\n      merkleTrees.push({\r\n        root: order.apiOrder.merkleRoot ?? '0x0000000000000000000000000000000000000000000000000000000000000000',\r\n        proof: order.apiOrder.merkleProof ?? [],\r\n      })\r\n    })\r\n\r\n    return { takerBids, makerOrders, makerSignatures, totalValue, merkleTrees }\r\n  }\r\n}\r\n","import abi from '../../../abis/NFT20.json'\r\nimport { Interface } from '@ethersproject/abi'\r\nimport { TradeConfig } from '../Command'\r\nimport { NFTTrade, Market, TokenType, BuyItem } from '../NFTTrade'\r\nimport { RoutePlanner, CommandType } from '../../utils/routerCommands'\r\nimport { BigNumber, BigNumberish } from 'ethers'\r\n\r\nexport type NFT20Data = {\r\n  tokenAddress: string\r\n  tokenIds: BigNumberish[]\r\n  tokenAmounts: BigNumberish[]\r\n  recipient: string\r\n  fee: BigNumberish\r\n  isV3: boolean\r\n  value: BigNumberish\r\n}\r\n\r\nexport class NFT20Trade extends NFTTrade<NFT20Data> {\r\n  public static INTERFACE: Interface = new Interface(abi)\r\n\r\n  constructor(orders: NFT20Data[]) {\r\n    super(Market.NFT20, orders)\r\n  }\r\n\r\n  encode(planner: RoutePlanner, config: TradeConfig): void {\r\n    for (const order of this.orders) {\r\n      const calldata = NFT20Trade.INTERFACE.encodeFunctionData('ethForNft', [\r\n        order.tokenAddress,\r\n        order.tokenIds,\r\n        order.tokenAmounts,\r\n        order.recipient,\r\n        order.fee,\r\n        order.isV3,\r\n      ])\r\n      planner.addCommand(CommandType.NFT20, [order.value, calldata], config.allowRevert)\r\n    }\r\n  }\r\n\r\n  getBuyItems(): BuyItem[] {\r\n    let buyItems: BuyItem[] = []\r\n    for (const pool of this.orders) {\r\n      for (const tokenId of pool.tokenIds) {\r\n        buyItems.push({\r\n          tokenAddress: pool.tokenAddress,\r\n          tokenId: tokenId,\r\n          tokenType: TokenType.ERC721,\r\n        })\r\n      }\r\n    }\r\n\r\n    return buyItems\r\n  }\r\n\r\n  getTotalPrice(): BigNumber {\r\n    let total = BigNumber.from(0)\r\n    for (const item of this.orders) {\r\n      total = total.add(item.value)\r\n    }\r\n    return total\r\n  }\r\n}\r\n","import abi from '../../../abis/NFTXZap.json'\r\nimport { Interface } from '@ethersproject/abi'\r\nimport { BuyItem, Market, NFTTrade, TokenType } from '../NFTTrade'\r\nimport { TradeConfig } from '../Command'\r\nimport { RoutePlanner, CommandType } from '../../utils/routerCommands'\r\nimport { BigNumber, BigNumberish } from 'ethers'\r\n\r\nexport type NFTXData = {\r\n  recipient: string\r\n  vaultId: BigNumberish\r\n  tokenAddress: string\r\n  tokenIds: BigNumberish[]\r\n  value: BigNumber\r\n  swapCalldata: string\r\n}\r\n\r\nexport class NFTXTrade extends NFTTrade<NFTXData> {\r\n  public static INTERFACE: Interface = new Interface(abi)\r\n\r\n  constructor(orders: NFTXData[]) {\r\n    super(Market.NFTX, orders)\r\n  }\r\n\r\n  encode(planner: RoutePlanner, config: TradeConfig): void {\r\n    for (const order of this.orders) {\r\n      const calldata = NFTXTrade.INTERFACE.encodeFunctionData('buyAndRedeem', [\r\n        order.vaultId,\r\n        order.tokenIds.length,\r\n        order.tokenIds,\r\n        order.swapCalldata,\r\n        order.recipient,\r\n      ])\r\n\r\n      planner.addCommand(CommandType.NFTX, [order.value, calldata], config.allowRevert)\r\n    }\r\n  }\r\n\r\n  getBuyItems(): BuyItem[] {\r\n    let buyItems: BuyItem[] = []\r\n    for (const order of this.orders) {\r\n      for (const tokenId of order.tokenIds) {\r\n        buyItems.push({\r\n          tokenAddress: order.tokenAddress,\r\n          tokenId: tokenId,\r\n          tokenType: TokenType.ERC721,\r\n        })\r\n      }\r\n    }\r\n    return buyItems\r\n  }\r\n\r\n  getTotalPrice(): BigNumber {\r\n    let total = BigNumber.from(0)\r\n    for (const item of this.orders) {\r\n      total = total.add(item.value)\r\n    }\r\n    return total\r\n  }\r\n}\r\n","import { BigNumber, BigNumberish } from 'ethers'\r\nimport { Interface } from '@ethersproject/abi'\r\nimport abi from '../../../abis/Seaport.json'\r\nimport { BuyItem, Market, NFTTrade, TokenType } from '../NFTTrade'\r\nimport { TradeConfig } from '../Command'\r\nimport { RoutePlanner, CommandType } from '../../utils/routerCommands'\r\nimport { encodeInputTokenOptions, Permit2Permit } from '../../utils/inputTokens'\r\nimport { ETH_ADDRESS } from '../../utils/constants'\r\n\r\nexport type SeaportData = {\r\n  items: Order[]\r\n  recipient: string // address\r\n  protocolAddress: string\r\n  inputTokenProcessing?: InputTokenProcessing[]\r\n}\r\n\r\nexport type InputTokenProcessing = {\r\n  token: string\r\n  permit2Permit?: Permit2Permit\r\n  protocolApproval: boolean\r\n  permit2TransferFrom: boolean\r\n}\r\n\r\nexport type FulfillmentComponent = {\r\n  orderIndex: BigNumberish\r\n  itemIndex: BigNumberish\r\n}\r\n\r\nexport type OfferItem = {\r\n  itemType: BigNumberish // enum\r\n  token: string // address\r\n  identifierOrCriteria: BigNumberish\r\n  startAmount: BigNumberish\r\n  endAmount: BigNumberish\r\n}\r\n\r\nexport type ConsiderationItem = OfferItem & {\r\n  recipient: string\r\n}\r\n\r\nexport type Order = {\r\n  parameters: OrderParameters\r\n  signature: string\r\n}\r\n\r\ntype OrderParameters = {\r\n  offerer: string // address,\r\n  offer: OfferItem[]\r\n  consideration: ConsiderationItem[]\r\n  orderType: BigNumberish // enum\r\n  startTime: BigNumberish\r\n  endTime: BigNumberish\r\n  zoneHash: string // bytes32\r\n  zone: string // address\r\n  salt: BigNumberish\r\n  conduitKey: string // bytes32,\r\n  totalOriginalConsiderationItems: BigNumberish\r\n}\r\n\r\nexport type AdvancedOrder = Order & {\r\n  numerator: BigNumber // uint120\r\n  denominator: BigNumber // uint120\r\n  extraData: string // bytes\r\n}\r\n\r\nexport class SeaportTrade extends NFTTrade<SeaportData> {\r\n  public static INTERFACE: Interface = new Interface(abi)\r\n  public static OPENSEA_CONDUIT_KEY: string = '0x0000007b02230091a7ed01230072f7006a004d60a8d4e71d599b8104250f0000'\r\n\r\n  constructor(orders: SeaportData[]) {\r\n    super(Market.Seaport, orders)\r\n  }\r\n\r\n  encode(planner: RoutePlanner, config: TradeConfig): void {\r\n    for (const order of this.orders) {\r\n      let advancedOrders: AdvancedOrder[] = []\r\n      let orderFulfillments: FulfillmentComponent[][] = order.items.map((_, index) => [\r\n        { orderIndex: index, itemIndex: 0 },\r\n      ])\r\n      let considerationFulFillments: FulfillmentComponent[][] = this.getConsiderationFulfillments(order.items)\r\n\r\n      for (const item of order.items) {\r\n        const { advancedOrder } = this.getAdvancedOrderParams(item)\r\n        advancedOrders.push(advancedOrder)\r\n      }\r\n\r\n      let calldata: string\r\n      if (advancedOrders.length == 1) {\r\n        calldata = SeaportTrade.INTERFACE.encodeFunctionData('fulfillAdvancedOrder', [\r\n          advancedOrders[0],\r\n          [],\r\n          SeaportTrade.OPENSEA_CONDUIT_KEY,\r\n          order.recipient,\r\n        ])\r\n      } else {\r\n        calldata = SeaportTrade.INTERFACE.encodeFunctionData('fulfillAvailableAdvancedOrders', [\r\n          advancedOrders,\r\n          [],\r\n          orderFulfillments,\r\n          considerationFulFillments,\r\n          SeaportTrade.OPENSEA_CONDUIT_KEY,\r\n          order.recipient,\r\n          100, // TODO: look into making this a better number\r\n        ])\r\n      }\r\n\r\n      if (!!order.inputTokenProcessing) {\r\n        for (const inputToken of order.inputTokenProcessing)\r\n          encodeInputTokenOptions(planner, {\r\n            approval: inputToken.protocolApproval\r\n              ? { token: inputToken.token, protocol: order.protocolAddress }\r\n              : undefined,\r\n            permit2Permit: inputToken.permit2Permit,\r\n            permit2TransferFrom: inputToken.permit2TransferFrom\r\n              ? { token: inputToken.token, amount: this.getTotalOrderPrice(order, inputToken.token).toString() }\r\n              : undefined,\r\n          })\r\n      }\r\n\r\n      planner.addCommand(\r\n        this.commandMap(order.protocolAddress),\r\n        [this.getTotalOrderPrice(order, ETH_ADDRESS).toString(), calldata],\r\n        config.allowRevert\r\n      )\r\n    }\r\n  }\r\n\r\n  getBuyItems(): BuyItem[] {\r\n    let buyItems: BuyItem[] = []\r\n    for (const order of this.orders) {\r\n      for (const item of order.items) {\r\n        for (const offer of item.parameters.offer) {\r\n          buyItems.push({\r\n            tokenAddress: offer.token,\r\n            tokenId: offer.identifierOrCriteria,\r\n            tokenType: TokenType.ERC721,\r\n          })\r\n        }\r\n      }\r\n    }\r\n    return buyItems\r\n  }\r\n\r\n  getInputTokens(): Set<string> {\r\n    let inputTokens = new Set<string>()\r\n    for (const order of this.orders) {\r\n      for (const item of order.items) {\r\n        for (const consideration of item.parameters.consideration) {\r\n          const token = consideration.token.toLowerCase()\r\n          inputTokens.add(token)\r\n        }\r\n      }\r\n    }\r\n    return inputTokens\r\n  }\r\n\r\n  getTotalOrderPrice(order: SeaportData, token: string = ETH_ADDRESS): BigNumber {\r\n    let totalOrderPrice = BigNumber.from(0)\r\n    for (const item of order.items) {\r\n      totalOrderPrice = totalOrderPrice.add(this.calculateValue(item.parameters.consideration, token))\r\n    }\r\n    return totalOrderPrice\r\n  }\r\n\r\n  getTotalPrice(token: string = ETH_ADDRESS): BigNumber {\r\n    let totalPrice = BigNumber.from(0)\r\n    for (const order of this.orders) {\r\n      for (const item of order.items) {\r\n        totalPrice = totalPrice.add(this.calculateValue(item.parameters.consideration, token))\r\n      }\r\n    }\r\n    return totalPrice\r\n  }\r\n\r\n  private commandMap(protocolAddress: string): CommandType {\r\n    switch (protocolAddress.toLowerCase()) {\r\n      case '0x00000000000000adc04c56bf30ac9d3c0aaf14dc': // Seaport v1.5\r\n        return CommandType.SEAPORT_V1_5\r\n      case '0x00000000000001ad428e4906ae43d8f9852d0dd6': // Seaport v1.4\r\n        return CommandType.SEAPORT_V1_4\r\n      default:\r\n        throw new Error('unsupported Seaport address')\r\n    }\r\n  }\r\n\r\n  private getConsiderationFulfillments(protocolDatas: Order[]): FulfillmentComponent[][] {\r\n    let considerationFulfillments: FulfillmentComponent[][] = []\r\n    const considerationRecipients: string[] = []\r\n\r\n    for (const i in protocolDatas) {\r\n      const protocolData = protocolDatas[i]\r\n\r\n      for (const j in protocolData.parameters.consideration) {\r\n        const item = protocolData.parameters.consideration[j]\r\n\r\n        if (considerationRecipients.findIndex((x) => x === item.recipient) === -1) {\r\n          considerationRecipients.push(item.recipient)\r\n        }\r\n\r\n        const recipientIndex = considerationRecipients.findIndex((x) => x === item.recipient)\r\n\r\n        if (!considerationFulfillments[recipientIndex]) {\r\n          considerationFulfillments.push([\r\n            {\r\n              orderIndex: i,\r\n              itemIndex: j,\r\n            },\r\n          ])\r\n        } else {\r\n          considerationFulfillments[recipientIndex].push({\r\n            orderIndex: i,\r\n            itemIndex: j,\r\n          })\r\n        }\r\n      }\r\n    }\r\n    return considerationFulfillments\r\n  }\r\n\r\n  private getAdvancedOrderParams(data: Order): { advancedOrder: AdvancedOrder } {\r\n    const advancedOrder = {\r\n      parameters: data.parameters,\r\n      numerator: BigNumber.from('1'),\r\n      denominator: BigNumber.from('1'),\r\n      signature: data.signature,\r\n      extraData: '0x00',\r\n    }\r\n    return { advancedOrder }\r\n  }\r\n\r\n  private calculateValue(considerations: ConsiderationItem[], token: string): BigNumber {\r\n    return considerations.reduce(\r\n      (amt: BigNumber, consideration: ConsiderationItem) =>\r\n        consideration.token.toLowerCase() == token.toLowerCase() ? amt.add(consideration.startAmount) : amt,\r\n      BigNumber.from(0)\r\n    )\r\n  }\r\n}\r\n","import abi from '../../../abis/Sudoswap.json'\r\nimport { Interface } from '@ethersproject/abi'\r\nimport { BuyItem, Market, NFTTrade, TokenType } from '../NFTTrade'\r\nimport { TradeConfig } from '../Command'\r\nimport { RoutePlanner, CommandType } from '../../utils/routerCommands'\r\nimport { BigNumber, BigNumberish } from 'ethers'\r\n\r\ntype PairSwap = {\r\n  swapInfo: {\r\n    pair: string // address\r\n    nftIds: BigNumberish[]\r\n  }\r\n  tokenAddress: string // address\r\n  maxCost: BigNumberish\r\n}\r\n\r\nexport type SudoswapData = {\r\n  swaps: PairSwap[]\r\n  nftRecipient: string\r\n  ethRecipient: string\r\n  deadline: BigNumberish\r\n}\r\n\r\nexport class SudoswapTrade extends NFTTrade<SudoswapData> {\r\n  public static INTERFACE: Interface = new Interface(abi)\r\n\r\n  constructor(orders: SudoswapData[]) {\r\n    super(Market.Sudoswap, orders)\r\n  }\r\n\r\n  encode(planner: RoutePlanner, config: TradeConfig): void {\r\n    for (const order of this.orders) {\r\n      const calldata = SudoswapTrade.INTERFACE.encodeFunctionData('robustSwapETHForSpecificNFTs', [\r\n        order.swaps.map((swap) => {\r\n          return { swapInfo: swap.swapInfo, maxCost: swap.maxCost }\r\n        }),\r\n        order.ethRecipient,\r\n        order.nftRecipient,\r\n        order.deadline,\r\n      ])\r\n      const value = order.swaps.reduce((prevVal, swap) => {\r\n        return prevVal.add(swap.maxCost)\r\n      }, BigNumber.from(0))\r\n      planner.addCommand(CommandType.SUDOSWAP, [value, calldata], config.allowRevert)\r\n    }\r\n  }\r\n\r\n  getBuyItems(): BuyItem[] {\r\n    let buyItems: BuyItem[] = []\r\n    for (const order of this.orders) {\r\n      for (const swap of order.swaps) {\r\n        for (const tokenId of swap.swapInfo.nftIds) {\r\n          buyItems.push({\r\n            tokenAddress: swap.tokenAddress,\r\n            tokenId,\r\n            tokenType: TokenType.ERC721,\r\n          })\r\n        }\r\n      }\r\n    }\r\n    return buyItems\r\n  }\r\n\r\n  getTotalPrice(): BigNumber {\r\n    let total = BigNumber.from(0)\r\n    for (const order of this.orders) {\r\n      for (const swap of order.swaps) {\r\n        total = total.add(swap.maxCost)\r\n      }\r\n    }\r\n    return total\r\n  }\r\n}\r\n","import abi from '../../../abis/X2Y2.json'\r\nimport { Interface } from '@ethersproject/abi'\r\nimport { BuyItem, Market, NFTTrade, TokenType } from '../NFTTrade'\r\nimport { TradeConfig } from '../Command'\r\nimport { RoutePlanner, CommandType } from '../../utils/routerCommands'\r\nimport { BigNumber, BigNumberish } from 'ethers'\r\n\r\ntype X2Y2PartialData = {\r\n  signedInput: string\r\n  recipient: string\r\n  tokenAddress: string\r\n  tokenId: BigNumberish\r\n  price: BigNumberish\r\n}\r\n\r\nexport type X2Y2_721_Data = X2Y2PartialData & {\r\n  tokenType: TokenType.ERC721\r\n}\r\n\r\nexport type X2Y2_1155_Data = X2Y2PartialData & {\r\n  tokenType: TokenType.ERC1155\r\n  tokenAmount: BigNumberish\r\n}\r\n\r\nexport type X2Y2Data = X2Y2_721_Data | X2Y2_1155_Data\r\n\r\nexport class X2Y2Trade extends NFTTrade<X2Y2Data> {\r\n  public static INTERFACE: Interface = new Interface(abi)\r\n\r\n  constructor(orders: X2Y2Data[]) {\r\n    super(Market.X2Y2, orders)\r\n  }\r\n\r\n  encode(planner: RoutePlanner, config: TradeConfig): void {\r\n    for (const item of this.orders) {\r\n      const functionSelector = X2Y2Trade.INTERFACE.getSighash(X2Y2Trade.INTERFACE.getFunction('run'))\r\n      const calldata = functionSelector + item.signedInput.slice(2)\r\n\r\n      if (item.tokenType == TokenType.ERC721) {\r\n        planner.addCommand(\r\n          CommandType.X2Y2_721,\r\n          [item.price, calldata, item.recipient, item.tokenAddress, item.tokenId],\r\n          config.allowRevert\r\n        )\r\n      } else if (item.tokenType == TokenType.ERC1155) {\r\n        planner.addCommand(\r\n          CommandType.X2Y2_1155,\r\n          [item.price, calldata, item.recipient, item.tokenAddress, item.tokenId, item.tokenAmount],\r\n          config.allowRevert\r\n        )\r\n      }\r\n    }\r\n  }\r\n\r\n  getBuyItems(): BuyItem[] {\r\n    let buyItems: BuyItem[] = []\r\n    for (const item of this.orders) {\r\n      buyItems.push({\r\n        tokenAddress: item.tokenAddress,\r\n        tokenId: item.tokenId,\r\n        tokenType: item.tokenType,\r\n      })\r\n    }\r\n    return buyItems\r\n  }\r\n\r\n  getTotalPrice(): BigNumber {\r\n    let total = BigNumber.from(0)\r\n    for (const item of this.orders) {\r\n      total = total.add(item.price)\r\n    }\r\n    return total\r\n  }\r\n}\r\n","import invariant from 'tiny-invariant'\r\nimport { BigNumberish } from 'ethers'\r\nimport { RoutePlanner, CommandType } from '../../utils/routerCommands'\r\nimport { encodeInputTokenOptions, Permit2Permit } from '../../utils/inputTokens'\r\nimport { Command, RouterTradeType, TradeConfig } from '../Command'\r\nimport { ROUTER_AS_RECIPIENT, WETH_ADDRESS } from '../../utils/constants'\r\n\r\nexport class UnwrapWETH implements Command {\r\n  readonly tradeType: RouterTradeType = RouterTradeType.UnwrapWETH\r\n  readonly permit2Data: Permit2Permit\r\n  readonly wethAddress: string\r\n  readonly amount: BigNumberish\r\n\r\n  constructor(amount: BigNumberish, chainId: number, permit2?: Permit2Permit) {\r\n    this.wethAddress = WETH_ADDRESS(chainId)\r\n    this.amount = amount\r\n\r\n    if (!!permit2) {\r\n      invariant(\r\n        permit2.details.token.toLowerCase() === this.wethAddress.toLowerCase(),\r\n        `must be permitting WETH address: ${this.wethAddress}`\r\n      )\r\n      invariant(permit2.details.amount >= amount, `Did not permit enough WETH for unwrapWETH transaction`)\r\n      this.permit2Data = permit2\r\n    }\r\n  }\r\n\r\n  encode(planner: RoutePlanner, _: TradeConfig): void {\r\n    encodeInputTokenOptions(planner, {\r\n      permit2Permit: this.permit2Data,\r\n      permit2TransferFrom: {\r\n        token: this.wethAddress,\r\n        amount: this.amount.toString(),\r\n      },\r\n    })\r\n    planner.addCommand(CommandType.UNWRAP_WETH, [ROUTER_AS_RECIPIENT, this.amount])\r\n  }\r\n}\r\n"],"names":["RouterTradeType","NFTTrade","market","orders","length","invariant","Market","TokenType","CommandType","ALLOW_REVERT_FLAG","REVERTIBLE_COMMANDS","Set","SEAPORT_V1_5","SEAPORT_V1_4","NFTX","LOOKS_RARE_V2","X2Y2_721","X2Y2_1155","FOUNDATION","SUDOSWAP","NFT20","EXECUTE_SUB_PLAN","CRYPTOPUNKS","ELEMENT_MARKET","PERMIT_STRUCT","PERMIT_BATCH_STRUCT","PERMIT2_TRANSFER_FROM_STRUCT","PERMIT2_TRANSFER_FROM_BATCH_STRUCT","ABI_DEFINITION","PERMIT2_PERMIT","PERMIT2_PERMIT_BATCH","PERMIT2_TRANSFER_FROM","PERMIT2_TRANSFER_FROM_BATCH","V3_SWAP_EXACT_IN","V3_SWAP_EXACT_OUT","V2_SWAP_EXACT_IN","V2_SWAP_EXACT_OUT","WRAP_ETH","UNWRAP_WETH","SWEEP","SWEEP_ERC721","SWEEP_ERC1155","TRANSFER","PAY_PORTION","BALANCE_CHECK_ERC20","OWNER_CHECK_721","OWNER_CHECK_1155","APPROVE_ERC20","RoutePlanner","commands","inputs","addSubPlan","subplan","addCommand","type","parameters","allowRevert","command","createCommand","push","encodedInput","has","Error","concat","toString","padStart","defaultAbiCoder","encode","UNIVERSAL_ROUTER_ADDRESS","chainId","WETH_ADDRESS","PERMIT2_ADDRESS","CONTRACT_BALANCE","BigNumber","from","pow","ETH_ADDRESS","ZERO_ADDRESS","SENDER_AS_RECIPIENT","ROUTER_AS_RECIPIENT","OPENSEA_CONDUIT_SPENDER_ID","SUDOSWAP_SPENDER_ID","REFUND_ETH_PRICE_IMPACT_THRESHOLD","Percent","JSBI","BigInt","UniswapTrade","trade","options","planner","_config","payerIsUser","inputAmount","currency","isNative","maximumAmountIn","slippageTolerance","quotient","recipient","performAggregatedSlippageCheck","tradeType","TradeType","EXACT_INPUT","routes","outputIsNative","outputAmount","inputIsNative","routerMustCustody","swaps","swap","route","protocol","Protocol","V2","addV2Swap","V3","addV3Swap","MIXED","addMixedSwap","minimumAmountOut","wrapped","address","EXACT_OUTPUT","riskOfPartialFill","V2Trade","path","map","pool","V3Trade","createUncheckedTrade","encodeRouteToPath","tradeRecipient","pools","Pool","Pair","MixedRouteTrade","amountIn","amountOut","sections","partitionMixedRouteByProtocol","isLastSectionInRoute","i","outputToken","inputToken","input","section","getOutputOfPools","newRouteOriginal","MixedRouteSDK","token0","equals","token1","newRoute","MixedRoute","mixedRouteIsAllV3","every","encodeMixedRouteToPath","liquidityToken","priceImpact","greaterThan","SIGNATURE_LENGTH","EIP_2098_SIGNATURE_LENGTH","encodePermit","permit2","signature","ethers","utils","arrayify","joinSignature","splitSignature","encodeInputTokenOptions","approval","permit2Permit","token","details","permit2TransferFrom","mapApprovalProtocol","amount","protocolAddress","toLowerCase","SwapRouter","swapCallParameters","trades","config","Array","isArray","nftTrades","filter","_","hasOwnProperty","currentNativeValueInRouter","transactionValue","nftInputTokens","nftTrade","tradePrice","getTotalPrice","Seaport","seaportTrade","seaportInputTokens","getInputTokens","forEach","add","lt","sub","uniswapTrade","swapOptions","inputTokenPermit","UnwrapWETH","encodePlan","swapNFTCallParameters","totalPrice","swapERC20CallParameters","inputCurrency","nativeCurrencyValue","deadline","deadlineOrPreviousBlockhash","undefined","functionSignature","calldata","INTERFACE","encodeFunctionData","value","toHexString","Interface","abi","CryptopunkTrade","Cryptopunks","item","tokenId","getBuyItems","buyItems","tokenAddress","CRYPTOPUNK_ADDRESS","tokenType","Cryptopunk","total","FoundationTrade","Foundation","price","referrer","ERC721","LooksRareV2Trade","LooksRareV2","refactorAPIData","takerBids","makerOrders","makerSignatures","totalValue","merkleTrees","apiOrder","collection","collectionType","ERC721_ORDER","ERC1155","itemIds","order","taker","additionalParameters","root","merkleRoot","proof","merkleProof","NFT20Trade","tokenIds","tokenAmounts","fee","isV3","NFTXTrade","vaultId","swapCalldata","SeaportTrade","advancedOrders","orderFulfillments","items","index","orderIndex","itemIndex","considerationFulFillments","getConsiderationFulfillments","getAdvancedOrderParams","advancedOrder","OPENSEA_CONDUIT_KEY","inputTokenProcessing","protocolApproval","getTotalOrderPrice","commandMap","offer","identifierOrCriteria","inputTokens","consideration","totalOrderPrice","calculateValue","protocolDatas","considerationFulfillments","considerationRecipients","protocolData","j","findIndex","x","recipientIndex","data","numerator","denominator","extraData","considerations","reduce","amt","startAmount","SudoswapTrade","Sudoswap","swapInfo","maxCost","ethRecipient","nftRecipient","prevVal","nftIds","X2Y2Trade","X2Y2","functionSelector","getSighash","getFunction","signedInput","slice","tokenAmount","wethAddress","permit2Data"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}